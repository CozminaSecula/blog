---
title: "Segmenting for Perspective: Discover Insights Through Segmentation"
description: "Discover how segmentation can help an organization to understand compensation differences across various factors such as roles, departments, experience, and demographic groups."
author: "Cozmina Secula"
date: 2023-11-17
categories: [employee segmentation, people analytics]
image: image.jpeg
format: html
editor: visual
execute: 
  echo: true
  warning: false
code-fold: true
code-link: true
code-tools: true
fig-align: center
fig-height: 6
fig-width: 8
---

# Project Description

## The Context

-   Imagine a company that offers a wide range of products and services. This company values inclusivity and diversity in its workforce, ensuring representation across essential roles. However, their compensation strategy has remained stagnant for the past three years despite the organization's growth and success over time.

-   The company aims to understand disparities in compensation, seeking insights based on factors such as roles, departments, experience, and demographic groups. This understanding will enable the company to address potential inequities and enhance its compensation strategy effectively.

-   How can the company employ data analytics to gain insights into compensation differences?

## Aim of this project

âœ… To understand compensation differences across various factors such as roles, departments, experience, and demographic groups through segmenting employee data.

-   This will help inform the development of a competitive compensation strategy.

-   A competitive compensation strategy can help attract and retain top talent, improve employee morale and motivation, and ultimately drive business success.

## Research Questions

-   How does compensation compare across different departments, roles, and experience levels?

-   Are there any disparities in compensation between different demographic groups that can be addressed?

## Data Collection

-   Data is sourced from the book : [The Fundamentals of People Analytics With Applications in R](https://link.springer.com/book/10.1007/978-3-031-28674-2)

-   The data set used in this project is **`employees`** and contains information on active and terminated employees, with a data dictionary available in the book.

## Load libraries

```{r}
library(tidyverse)
library(peopleanalytics)
library(skimr)
library(DT)
library(kableExtra)
library(gt)
library(ggtext)
library(cowplot) 
library(scales)
library(patchwork) 
library(paletteer)
library(gtExtras)
library(ggridges)

```

## A glimpse at the data set

```{r}
data("employees")

peopleanalytics::employees|>
      DT::datatable((options = list(pageLength = 5)))
    
```

::: {.callout-note appearance="simple"}
There are observations for 1470 employees and 36 variables.
:::

## Data summary

```{r}

employees|>
  skimr::skim()|>
  DT::datatable((options = list(pageLength = 5)))

```

::: {.callout-note appearance="simple"}
-   There are 8 categorical (qualitative) variables and 28 continuous (quantitative) variables.

-   No missing values for categorical variables. Continuous variables `yts_leads` and `ytd_sales` each have 1061 missing values.

-   The data are documented in a data dictionary available in the book.
:::

# Analysis

To answer the research questions, a **descriptive analysis** will be performed to compare compensation differences across various factors such as roles, departments, experience, and demographic groups.

## 1. How does compensation compare across different departments, roles, and experience levels?

### Variables of interest

| Variable of interest | Variable Name (data set) | Description of Variable                                                                                                                                              | Data type   |
|--------------|--------------|-----------------------------|--------------|
| Compensation         | annual_comp              | Hourly rate \* 2080                                                                                                                                                  | Continuous  |
| Role                 | job_title                | Job title                                                                                                                                                            | Categorical |
| Department           | dept                     | Department of which an employee is a member                                                                                                                          | Categorical |
| Experience           | job_lvl                  | Job level, where 1 = Junior and 5 = Senior                                                                                                                           | Categorical |
| Salary Increase      | salary_hike_pct          | The percent increase in salary for the employee's most recent compensation adjustment (whether due to a standard merit increase, off-cycle adjustment, or promotion) | Continuous  |
| Work experience      | work_exp                 | Total years of work experience                                                                                                                                       | Continuous  |

### Data Preparation

#### Compensation

```{r}

min(employees$annual_comp) #min value for annual compensation
max(employees$annual_comp) #max value for annual compensation

## Create a new variable with interval values for compensation (annual_interval)

employees <- employees |>
  filter(active == "Yes") |>
  mutate(annual_interval = case_when(
    annual_comp < 100000 ~ "62.4k-100.0k",
    annual_comp >= 100000 & annual_comp < 150000 ~ "100.0K-150.0K",
    annual_comp >= 150000 & annual_comp < 200000 ~ "150.0K-200.0K",
    annual_comp >= 200000 & annual_comp <= 208000 ~ "200.0k-208.0K",
    annual_comp > 208000 ~ "Over 208.0k"
      ))

comp_value <- c(50000, 100000, 150000, 200000, Inf)
comp_interval <- c("62.4k-100.0k","100.0K-150.0k","150.0K-200.0K","200.0k-208.0K")
employees <- employees|>
  mutate(annual_interval=cut(annual_comp, ordered = TRUE,
                           breaks = comp_value,
                           labels = comp_interval))


levels(employees$annual_interval)

```

#### Role

```{r}

employees|>
  distinct(job_title)|> ## check the levels for role (job_title) variable
  datatable((options = list(pageLength = 5)))

```

#### Department

```{r}

employees|>
  distinct(dept)|> ## check the levels for department (dept) variable
  datatable()

```

#### Experience

```{r}

employees|>
  distinct(job_lvl)  ## check the levels for experience (job_lvl) variable

## Converting job_lvl from numeric to a factor 

employees <- employees|>
  mutate(job_level= factor(job_lvl, ordered = TRUE,
                              levels=c(1:5),
                              labels=c("Junior","Intermediate","Experienced","Expert","Senior")))
levels(employees$job_level)

```

#### Work Experience

```{r}
min(employees$work_exp) # min value for work experience
max(employees$work_exp) # max value for work experience

## Create a new variable with interval values for work experience (work_exp_interval)

employees <- employees |>
    filter(active== "Yes")|>
    mutate(work_exp_interval = case_when(
    work_exp >=0 & work_exp <10 ~ "0-10 years",
    work_exp >=10 & work_exp <20 ~ "10-20 years",
    work_exp >=20 & work_exp <30 ~ "20-30 years",
    work_exp >=30 & work_exp <38 ~ "30-38 years",
    work_exp > 38 ~ "Over 30 years"
          ))

work_exp_value <- c(0, 10, 20, 30, Inf)
work_exp_levels <- c("0-10 years","10-20 years","20-30 years","30-38 years")

employees <- employees|>
  mutate(work_exp_interval=cut(work_exp, ordered = TRUE, 
                           breaks = work_exp_value,
                           labels = work_exp_levels,
                           include.lowest = TRUE))

employees|>
  distinct(work_exp_interval)

```

#### Salary increase

```{r}

min(employees$salary_hike_pct) ## min value for last salary increase
max(employees$salary_hike_pct) ## max value for last salary increase

## Create a new variable with interval values for salary increase 

employees <- employees |>
    filter(active== "Yes")|>
    mutate(salary_increase_interval = case_when(
    salary_hike_pct >=11 & salary_hike_pct <15 ~ "11%-15%",
    salary_hike_pct >=15 & salary_hike_pct <20 ~ "15%-20%",
    salary_hike_pct >=20 & work_exp <25 ~ "20%-25%",
    salary_hike_pct > 25 ~ "Over 25%"
          ))

Salary_increase_value <- c(11, 15, 20, Inf)
salary_increase_levels <- c("11%-15%","15%-20%","20%-25%")

employees <- employees|>
  mutate(salary_increase_interval=cut(salary_hike_pct, ordered = TRUE,
                           breaks = Salary_increase_value,
                           labels = salary_increase_levels,
                           include.lowest = 11))


employees|>
  distinct(salary_increase_interval)

```

#### New data set

```{r}
#| output: false


## Create a new data set (employees1) with all variables of interest (transformed)

(employees1 <- employees|>
  filter(active=="Yes")|>
  select(dept, job_title, job_level, annual_interval, work_exp_interval, salary_increase_interval, annual_comp))
   

```

#### Data summary

```{r}

 gt_plt_summary(employees1) 

 datatable(employees1, options = list(pageLength = 5))
```

## Descriptive Statistics

```{r}
#| output: false

(data_annual_interval <- employees1|>
  group_by(annual_interval)|>
  summarise(Count=n()))
  

```

```{r}

ggplot(data_annual_interval, aes(x=reorder(annual_interval,Count),y=Count, fill=annual_interval))+
  geom_bar(stat = "identity", width = 0.4, fill="#6996E3FF")+
  geom_text(aes(label=Count), hjust= -0.2, size=3.5)+
  theme_minimal(base_size = 12)+
  labs(title="Distribution of Compensation by Intervals",
       subtitle = "Number of Employees",
        x= "Annual Interval",
         y= NULL)+
  theme(axis.title.x = element_text(angle = 360, hjust = 1.2),
        panel.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.background = element_blank(),
        axis.line.x = element_blank(),
        axis.text.x = element_blank())+
  guides(fill="none")+
  coord_flip()


```

### Compensation_Annual_Comp

```{r}

ggplot(employees|>filter(active=="Yes"), aes(x=annual_comp))+
  geom_histogram(binwidth = 5000, fill = "#C5DAF6FF", color="#4060C8FF")+
  labs(title="Annual Compensation of Active Employees",
       x= "Annual Compensation",
       y= "Frequency")

```

```{r}

colors <- c("62.4k-100.0k"= "#6996E3FF","100.0K-150.0k"="#1A318BFF" ,"150.0K-200.0K"= "#4060C8FF","200.0k-208.0K"="#C5DAF6FF")

ggplot(employees|>filter(active=="Yes"), aes(x=annual_comp, fill=annual_interval))+
  geom_histogram(binwidth = 5000,
                 alpha=0.5)+
  theme_minimal(base_size = 12) +
  scale_fill_manual(values = colors)+
  labs(title="Annual Compensation of Active Employees",
       subtitle = "Split by Intervals",
       x= "Annual Compensation",
       y= "Frequency")+
  facet_wrap(~annual_interval, nrow =4)+
  guides(fill="none")


```

```{r}
#| output: false

(prct_annua_interval <- table(employees$annual_interval)/ length(employees$annual_comp)*100)
  
  
```

::: {.callout-note appearance="simple"}
-   25.79% of the annual compensation of active employees falls between 62.4k-100.0k
-   68.28% of the annual compensation of active employees falls between 100.0k-200.0k
-   5.9% of the annual compensation of active employees falls between 200.0k-208.0k
:::

### Employees by Departments and Roles

```{r}

data_dept_role <- employees1|>
  group_by(dept, job_title)|>
  summarise(Count= n())|>
  mutate(job_title= forcats::fct_reorder(job_title, Count))

colors <- c("Human Resources" = "#EAF3FFFF", "Research & Development" = "#C5DAF6FF", "Sales"= "#A1C2EDFF")

ggplot(data_dept_role, aes(x = reorder(job_title,Count), y= Count, fill=dept))+
  geom_bar(stat = "identity", position = "dodge", width = 0.7)+
  geom_text(aes(label=Count), hjust= -0.2, position= position_dodge(0.9), size= 3.5)+
  theme_minimal(base_size = 12)+
  theme(
  strip.text.y = element_text(vjust = 0, margin = margin(1, 0, 1, 0), 
    size = rel(0.95), face = "bold"),
  panel.background = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  plot.background = element_blank(),
  axis.line.x = element_blank(),
  axis.text.x = element_blank())+
  labs(x="",
       title = "Employees by Departments and Roles",
       fill= "",
       y= "")+
  scale_fill_manual(values = colors)+
  coord_flip()+
  facet_grid(dept ~., scales = "free_y", space = "free_y", switch = "y")+
  guides(fill="none")


```

### Compensation by Department

```{r}

dept_comp_n <- employees1|>
  group_by(dept, annual_interval)|>
  summarise(Count= n())

ggplot(dept_comp_n, aes(x= annual_interval, y= dept, fill = Count)) +
  geom_tile() + 
  geom_text(aes(label=Count), vjust= 0.5, hjust= 0.5)+
  coord_fixed()+
  labs(title = 'A large portion of employees in R&D earn compensation ranging \nfrom 150.0K-200.0K.', 
       x= 'Compensation', 
       y= 'Department') +
  guides(fill = guide_legend(title = "Number of Employees")) +
  scale_fill_continuous(low = "#E5E6E8FF", high = "#0070C0") +
  theme(panel.background = element_blank(), 
        axis.ticks.x = element_blank(), 
        axis.ticks.y = element_blank(), 
        plot.title = element_text(hjust = 0),
        axis.title.x = element_text(margin = margin(t= 10, r= 0, b= 0, l= 0)),
        axis.title.y = element_text(margin = margin(t= 0, r= 10, b= 0, l= 0)),
        strip.text = element_textbox(
      size=12,
      color = "#404040" , face = "bold",
      halign = 0.5, linetype = 1, r= unit(5, "pt"), width = unit(1, "npc")))

```

### Compensation by Role

```{r}

job_title_comp_n <- employees1|>
  group_by(job_title, annual_interval)|>
  summarise(Count= n())

ggplot(job_title_comp_n, aes(x= annual_interval, y= job_title, fill = Count)) +
  geom_tile() + 
  coord_fixed()+
  geom_text(aes(label=Count), vjust= 0.5, hjust= 0.5)+
  labs(title = 'A significant number of Sales Executives (Sales) \nand Research Scientists (R&D) \nearn between 150.0K and 200.0K.',  
       x= 'Compensation', 
       y= 'Role') +
  guides(fill = guide_legend(title = "Number of Employees")) +
  scale_fill_continuous(low = "#E5E6E8FF", high = "#0070C0") +
  theme(panel.background = element_blank(), 
        axis.ticks.x = element_blank(), 
        axis.ticks.y = element_blank(), 
        plot.title = element_text(hjust = 0),
        axis.title.x = element_text(margin = margin(t= 10, r= 0, b= 0, l= 0)),
        axis.title.y = element_text(margin = margin(t= 0, r= 10, b= 0, l= 0)),
        strip.text = element_textbox(
      size=10,
      color = "#404040" , face = "bold",
      halign = 0.5, linetype = 1, r= unit(5, "pt"), width = unit(1, "npc")))


```

### How does **compensation** compare across **departments and roles**?

```{r}


colors <- c("Human Resources" = "#EAF3FFFF", "Research & Development" = "#C5DAF6FF", "Sales"= "#A1C2EDFF")

ggplot(employees1, aes(x=annual_comp, y=job_title, fill=dept))+
  geom_boxplot()+
  facet_wrap(~dept)+
  scale_fill_manual(values = colors)+
  scale_x_continuous(labels = scales::label_number(scale = 1e-3, suffix = "k", accuracy = 0.1),
                     limits= c(50e3, 250e3), breaks = seq(50e3, 250e3, by=50e3))+
  guides(fill="none")+
  labs(title = "The Sales Manager role has the highest average compensation, \nfollowed by the HR Manager. \nThe Vice President role has the lowest average compensation. \n",
       x= "Compensation",
       y= "Role")+
  theme_half_open(font_size=10)+
  background_grid()+
  theme(strip.background = element_blank(),
        strip.text = element_textbox(size=10,color = "#404040", fill = "#C5DAF6FF" , box.color = "#C5DAF6FF" , face = "bold", halign = 0.5, linetype = 1, r= unit(5, "pt"), width = unit(1, "npc"),
        padding = margin(2, 0, 1, 0), margin = margin(3, 3, 3, 3)),
        panel.spacing = unit(1, "lines"),
        axis.text.x = element_text(size = 7))
                   


```

### Compensation by Experience level

```{r}

job_level_comp_n <- employees1|>
  group_by(job_level, annual_interval)|>
  summarise(Count= n())

ggplot(job_level_comp_n,aes(x= annual_interval, y= job_level, fill = Count)) +
  geom_tile() + 
  geom_text(aes(label=Count), vjust= 0.5, hjust= 0.5)+
  coord_fixed()+
  labs(title = 'A significant number of employees with intermediate and junior levels of experience \nearn between 150.0K and 200.0K.',  
       x= 'Compensation', 
       y= 'Experience') +
  guides(fill = guide_legend(title = "Employee Count")) +
  scale_fill_continuous(low = "#E5E6E8FF", high = "#0070C0") +
  theme(panel.background = element_blank(), 
        axis.ticks.x = element_blank(), 
        axis.ticks.y = element_blank(), 
        plot.title = element_text(hjust = 0),
        axis.title.x = element_text(margin = margin(t= 10, r= 0, b= 0, l= 0)),
        axis.title.y = element_text(margin = margin(t= 0, r= 10, b= 0, l= 0)),
        strip.text = element_textbox(
      size=12,
      color = "#404040" , face = "bold",
      halign = 0.5, linetype = 1, r= unit(5, "pt"), width = unit(1, "npc")))

```

### How does **compensation** compare across **experience levels**?

```{r}

colors <- c("Human Resources" = "#EAF3FFFF", "Research & Development" = "#C5DAF6FF", "Sales"= "#A1C2EDFF")

ggplot(employees1, aes( x= job_level, y=annual_comp, fill=dept))+
  geom_boxplot()+
  facet_wrap(~ dept)+
  scale_fill_manual(values = colors)+
  scale_y_continuous(labels = scales::label_number(scale = 1e-3, suffix = "k", accuracy = 0.1),
                     limits= c(50e3, 250e3), breaks = seq(50e3, 250e3, by=50e3))+
  theme_half_open(10)+
  background_grid()+
  theme(
    strip.background = element_blank(),
    strip.text = element_textbox(size=10,color = "#404040", fill = "#C5DAF6FF" , box.color = "#C5DAF6FF" ,face = "bold", halign = 0.5, linetype = 1, r= unit(5, "pt"), width = unit(1, "npc"),
      padding = margin(2, 0, 1, 0), margin = margin(3, 3, 3, 3)),
      panel.spacing = unit(1, "lines"),
      axis.text.x = element_text(size = 7))+
    labs(title = "Senior level of experience in the Sales department has the highest \naverage compensation. The Expert level* of experience in the HR department \nhas the lowest average. \n",
       y= "Compensation",
       x= "Experience Levels")+
  coord_flip()+
  guides(fill="none")

```

::: {.callout-note appearance="simple"}
\*The boxplot for the Expert level in Human Resources shows an outlier. It is necessary to investigate why this observation has a value that is too large compared to other values for this category in the data set.
:::

### Salary Increase by Department

```{r}

## Salary Increase by Department

dept_salary_increase_n <- employees1|>
  group_by(dept, salary_increase_interval)|>
  summarise(Count= n())|>
  mutate(percentage=round(Count/sum(Count)*100,2))

ggplot(dept_salary_increase_n,aes(x= salary_increase_interval, y= dept, fill = percentage)) +
  geom_tile() + 
  geom_text(aes(label = percentage), vjust = 0.5, hjust = 0.5) +
  coord_fixed()+
  labs(title = 'At least 61% of employees from each department \nreceived a salary increase between 11%-15% \nfor their most recent compensation adjustment.',  
       x= 'Salary Increase', 
       y= 'Department') +
  guides(fill = guide_legend(title = "% of Employees")) +
  scale_fill_continuous(low = "#E5E6E8FF", high = "#0070C0") +
  theme(panel.background = element_blank(), 
        axis.ticks.x = element_blank(), 
        axis.ticks.y = element_blank(), 
        plot.title = element_text(hjust = 0),
        axis.title.x = element_text(margin = margin(t= 10, r= 0, b= 0, l= 0)),
        axis.title.y = element_text(margin = margin(t= 0, r= 10, b= 0, l= 0)),
        strip.text = element_textbox(
      size=12,
      color = "#404040" , face = "bold",
      hjust = 0.5, linetype = 1, r= unit(5, "pt"), width = unit(1, "npc")))


```

### Salary Increase by Role

```{r}
## Salary Increase by Role

role_salary_increase_n <- employees1|>
  group_by(job_title, salary_increase_interval)|>
  summarise(Count= n())|>
  mutate(percentage=round(Count/sum(Count)*100,2))

ggplot(role_salary_increase_n,aes(x= salary_increase_interval, y= job_title, fill = percentage)) +
  geom_tile() + 
  geom_text(aes(label = percentage), vjust = 0.5, hjust = 0.5) +
  coord_fixed()+
  labs(title = 'More than 54% of employees from each role \nreceived a salary increase between 11%-15% \nfor their most recent compensation adjustment.',  
       x= 'Salary Increase', 
       y= 'Role') +
  guides(fill = guide_legend(title = "% of Employees")) +
  scale_fill_continuous(low = "#E5E6E8FF", high = "#0070C0") +
  theme(panel.background = element_blank(), 
        axis.ticks.x = element_blank(), 
        axis.ticks.y = element_blank(), 
        plot.title = element_text(hjust = 0),
        axis.title.x = element_text(margin = margin(t= 10, r= 0, b= 0, l= 0)),
        axis.title.y = element_text(margin = margin(t= 0, r= 10, b= 0, l= 0)),
        strip.text = element_textbox(
      size=12,
      color = "#404040" , face = "bold",
      halign = 0.5, linetype = 1, r= unit(5, "pt"), width = unit(1, "npc")))
 
```

### Salary Increase by Experience level

```{r}

## Salary Increase By Experience 

experience_salary_increase_n <- employees1|>
  group_by(job_level, salary_increase_interval)|>
  summarise(Count= n())|>
  mutate(percentage=round(Count/sum(Count)*100,2))

ggplot(experience_salary_increase_n,aes(x= salary_increase_interval, y= job_level, fill = percentage)) +
  geom_tile() + 
  geom_text(aes(label = percentage), vjust = 0.5, hjust = 0.5) +
  coord_fixed()+
  labs(title = 'More than 60% of employees from each experience level \nreceived a salary increase between 11%-15% \nfor their most recent compensation adjustment.',  
       x= 'Salary Increase', 
       y= 'Experience level') +
  guides(fill = guide_legend(title = "% of Employees")) +
  scale_fill_continuous(low = "#E5E6E8FF", high = "#0070C0") +
  theme(panel.background = element_blank(), 
        axis.ticks.x = element_blank(), 
        axis.ticks.y = element_blank(), 
        plot.title = element_text(hjust = 0),
        axis.title.x = element_text(margin = margin(t= 10, r= 0, b= 0, l= 0)),
        axis.title.y = element_text(margin = margin(t= 0, r= 10, b= 0, l= 0)),
        strip.text = element_textbox(
      size=12,
      color = "#404040" , face = "bold",
      halign = 0.5, linetype = 1, r= unit(5, "pt"), width = unit(1, "npc")))
 
```

## 2. Are there any disparities in compensation between different demographic groups that can be addressed?

### Variables of interest

| Variable of interest | Variable Name (data set) | Description of Variable    | Data type   |
|------------------|------------------|--------------------|------------------|
| Age                  | age                      | Employee age in years      | Continuous  |
| Gender               | gender                   | Gender self-identification | Categorical |

### Data Preparation

#### Age

##### Define levels for generations

The generations are defined as follows:

| Generation Z | Millennial (Generation Y) | Generation X | Baby Boomers |
|--------------|---------------------------|--------------|--------------|
| Ages 18-24   | Ages 25-40                | Ages 41-56   | Ages 57-60   |

```{r}

min(employees$age) #min value for age variable
max(employees$age) #max value for age variable

## Create a new variable generation based on employees' age.


determine_generation <- function(age) {
  case_when(
    age >= 18 & age <= 24 ~ "Generation Z",
    age >= 25 & age <= 40 ~ "Millennial",
    age >= 41 & age <= 56 ~ "Generation X",
    age >= 57 & age <= 60 ~ "Baby Boomers",
    TRUE ~ "Age not in range"
  )
}


employees <- employees|>
  mutate(generation= determine_generation(age))

employees|>
  distinct(generation)|>
  datatable()

# Define the order of the levels

generation_cohort <- c("Generation Z", "Millennial", "Generation X", "Baby Boomers", "Age not in range")

# Convert the 'generation' variable to a factor and specify the order of the levels

employees$generation <- factor(employees$generation, levels = generation_cohort)

```

#### Gender

```{r}
employees|>
  distinct(gender)|>
  datatable()
```

## Descriptive Statistics

### Compensation By Generations

```{r}

employees|>
  filter(active== "Yes")|>
  group_by(generation)|>
  summarise(Total = n(),
            Mean= round(mean(annual_comp, na.rm = TRUE),2),
            Median= round(median(annual_comp, na.rm = TRUE),2),
            IQR= round(IQR(annual_comp, na.rm = TRUE),2),
            Sd.Dev = round(sd(annual_comp, na.rm = TRUE)))|>
  datatable()
```

### Compensation by Generational Groups

```{r}
comp_gen <- employees|>
  group_by(generation, annual_interval)|>
  filter(active == "Yes")|>
  summarise(Count=n())

ggplot(comp_gen,aes(x= annual_interval, y= generation, fill = Count)) +
  geom_tile() + 
  geom_text(aes(label = Count), vjust = 0.5, hjust = 0.5) +
  coord_fixed()+
  labs(title = 'A significant number of employees from the Millennial generation \nearn between 150.0K and 200.0K.',  
       x= 'Compensation', 
       y= 'Generation') +
  guides(fill = guide_legend(title = "Number of Employees")) +
  scale_fill_continuous(low = "#E5E6E8FF", high = "#0070C0") +
  theme(panel.background = element_blank(), 
        axis.ticks.x = element_blank(), 
        axis.ticks.y = element_blank(), 
        plot.title = element_text(hjust = 0),
        axis.title.x = element_text(margin = margin(t= 10, r= 0, b= 0, l= 0)),
        axis.title.y = element_text(margin = margin(t= 0, r= 10, b= 0, l= 0)),
        strip.text = element_textbox(
      size=12,
      color = "#404040" , face = "bold",
      halign = 0.5, linetype = 1, r= unit(5, "pt"), width = unit(1, "npc")))
```

### How does **compensation** compare among **generational groups**?

```{r}

comp_gen_dept <- employees|>
  group_by(generation, annual_comp, dept)|>
  filter(active == "Yes")

ggplot(comp_gen_dept, aes( x= generation, y=annual_comp, fill=dept))+
  geom_boxplot()+
  facet_grid(~ dept)+
  scale_fill_manual(values = colors)+
  theme_half_open(10)+
  background_grid()+
  theme(
    strip.background = element_blank(),
    strip.text = element_textbox(
      size=10,
      color = "#404040", fill = "#C5DAF6FF" , box.color = "#C5DAF6FF" , face = "bold",
      halign = 0.5, linetype = 1, r= unit(5, "pt"), width = unit(1, "npc"),
      padding = margin(2, 0, 1, 0), margin = margin(3, 3, 3, 3)),
      panel.spacing = unit(1, "lines"),
      axis.text.x = element_text(size = 7))+
  scale_y_continuous(labels = scales::label_number(scale = 1e-3, suffix = "k", accuracy = 0.1),
                     limits= c(50e3, 250e3), breaks = seq(50e3, 250e3, by=50e3))+
  labs(title = "The Baby Boomers group from the HR has the lowest average compensation,\n followed by the Generation Z group from the Sales department.\n",
       y= "Compensation",
       x= "Generation")+
  coord_flip()+
  guides(fill="none")

```

::: {.callout-note appearance="simple"}
\*The boxplot for the Baby Boomers generation from the R&D Department shows outliers. It is necessary to investigate why these observations have values that are too large compared to other values for this category in the data set.
:::

### Compensation by Gender

```{r}

employees|>
  filter(active== "Yes")|>
  group_by(gender)|>
  summarise(Total = n(),
            Mean= round(mean(annual_comp, na.rm = TRUE),2),
            Median= round(median(annual_comp, na.rm = TRUE),2),
            IQR= round(IQR(annual_comp, na.rm = TRUE),2),
            Sd.Dev = round(sd(annual_comp, na.rm = TRUE)))|>
  datatable()
```

### Compensation by Gender

```{r}
comp_gender <- employees|>
  group_by(gender, annual_interval)|>
  filter(active == "Yes")|>
  summarise(Count=n())

ggplot(comp_gender,aes(x= annual_interval, y= gender, fill = Count)) +
  geom_tile() + 
  geom_text(aes(label = Count), vjust = 0.5, hjust = 0.5) +
  coord_fixed()+
  labs(title = 'The highest number of employees for both men and women \nis in the 150.0k-200.0k range, \nwhile the lowest number of employees for both men and women \n is in the 200.0k-250.0k range.',  
       x= 'Compensation', 
       y= 'Gender') +
  guides(fill = guide_legend(title = "Employee Count")) +
  scale_fill_continuous(low = "#E5E6E8FF", high = "#0070C0") +
  theme(panel.background = element_blank(), 
        axis.ticks.x = element_blank(), 
        axis.ticks.y = element_blank(), 
        plot.title = element_text(hjust = 0),
        axis.title.x = element_text(margin = margin(t= 10, r= 0, b= 0, l= 0)),
        axis.title.y = element_text(margin = margin(t= 0, r= 10, b= 0, l= 0)),
        strip.text = element_textbox(
      size=12,
      color = "#404040" , face = "bold",
      halign = 0.5, linetype = 1, r= unit(5, "pt"), width = unit(1, "npc")))
```

### How does **compensation** compare among **genders**?

```{r}
comp_gender_dept <- employees|>
  group_by(gender, annual_comp, dept)|>
  filter(active == "Yes")

ggplot(comp_gender_dept, aes( x= gender, y=annual_comp, fill=dept))+
  geom_boxplot()+
  facet_grid(~ dept)+
  scale_fill_manual(values = colors)+
  theme_half_open(10)+
  background_grid()+
  theme(
    strip.background = element_blank(),
    strip.text = element_textbox(
      size=10,
      color = "#404040", fill = "#C5DAF6FF" , box.color = "#C5DAF6FF" ,face = "bold",
      halign = 0.5, linetype = 1, r= unit(5, "pt"), width = unit(1, "npc"),
      padding = margin(2, 0, 1, 0), margin = margin(3, 3, 3, 3)),
      panel.spacing = unit(1, "lines"),
      axis.text.x = element_text(size = 7))+
  scale_y_continuous(labels = scales::label_number(scale = 1e-3, suffix = "k", accuracy = 0.1),
                     limits= c(50e3, 250e3), breaks = seq(50e3, 250e3, by=50e3))+
  labs(title = "Women from the HR department have the lowest average compensation \ncompared with men within the same department and women from the other \ndepartments.\n",
       y= "Compensation",
       x= "Gender")+
  coord_flip()+
  guides(fill="none")
```

# Summary

## 1. How does compensation compare across different departments, roles, and experience levels?

-   The average annual compensation across all departments is 137.180\$

-   Annual Compensation Intervals

    -   25.79% of the annual compensation falls between 62.4k-100.0k
    -   68.28% of the annual compensation falls between 100.0k-200.0k
    -   5.9% of the annual compensation falls between 200.0k-208.0k

-   Compensation by Department

    -   A large portion of employees in R&D earn compensation ranging from 150.0K-200.0K

-   Compensation by Role

    -   A significant number of Sales Executives (Sales) and Research Scientists (R&D) earn between 150.0K and 200.0K.
    -   The Sales Manager role has the highest average compensation, followed by the HR Manager.
    -   The Vice President role has the lowest average compensation.

-   Compensation by Experience levels

    -   A significant number of employees with intermediate and junior levels of experience earn between 150.0K and 200.0K
    -   Senior level of experience in the Sales department has the highest average compensation.
    -   The Expert level of experience in the HR department has the lowest average.

-   Last Salary Increase

    -   By Department: At least 61% of employees from each department received a salary increase between 11%-15% for their most recent compensation adjustment.
    -   By Role: More than 54% of employees from each role received a salary increase between 11%-15% for their most recent compensation adjustment.
    -   By Experience Level: More than 60% of employees from each experience level received a salary increase between 11%-15% for their most recent compensation adjustment.

## 2. Are there any disparities in compensation between different demographic groups that can be addressed?

-   Compensation By Generations

    -   A significant number of employees from the Millennial generation earn between 150.0K and 200.0K.

    -   The Baby Boomers group from the HR department has the lowest average compensation, followed by the Generation Z group from the Sales department.

-   Compensation By Gender

    -   The highest number of employees for both men and women is in the 150.0k-200.0k range, while the lowest number of employees for both men and women  is in the 200.0k-250.0k range.
    -   Women from the HR department have the lowest average compensation compared with men within the same department and women from the other departments.

# Conclusion

Through this project, I aimed to understand compensation differences across various factors such as roles, departments, experience, and demographic groups through segmenting employee data. This may help inform the development of a competitive compensation strategy. A competitive compensation strategy can help attract and retain top talent, improve employee morale and motivation, and ultimately drive business success.

Employee data can be segmented by role, department, experience, and demographics to identify evidence-based learning opportunities. Identifying segments with high or low statistical differences from the average helped us better understand differences in compensation.

It is important to note that the information produced in the graphs of this project is limited to describing the sample of 1233 active employees for three departments. If we would be interested in making inferences about the population of the entire company, inferential statistical methods need to be applied to the data.
