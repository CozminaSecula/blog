{
  "hash": "b877af4d4e8c6eae0e80edc33b8fa656",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Key Driver Analysis to understand customer loyalty in a financial organization (case study)\"\ndescription: \"Analyzing a customer satisfaction survey to determine the most important factors influencing customer loyalty.\"\nauthor: \"Cozmina Secula\"\ndate: \"2024-01-15\"\ncategories: [key driver analysis, data cleaning, data visualization]\nimage: image.jpeg\ncode-fold: true\nsidebar: false\n---\n\n\n<br>\n\nIn the competitive business landscape, every organization strives to cultivate a loyal customer base. This loyalty, often a result of trust and satisfaction with a company’s products and services, is a key driver of repeat business. Consequently, companies are increasingly focusing on identifying and enhancing the critical factors influencing customer loyalty and encouraging repeat investments.\n\nThis post will guide you on how to use key driver analysis to identify the essential factors that impact customer satisfaction and, consequently, customer loyalty.\n\n# Problem statement\n\nA financial services organization intends to improve customer loyalty[^1], recognizing its importance in driving repeat investments. However, the organization currently lacks an understanding of the key drivers that significantly influence customer loyalty within the company.\n\n[^1]: The case study and the data description are sourced from the book [Predictive HR Analytics : Mastering the HR Metric](https://www.amazon.com/Predictive-HR-Analytics-Mastering-Metric/dp/0749473916) by Dr. Martin R. Edwards and Kirsten Edwards\n\n# Analysis Question\n\nWhat are the key factors influencing customer loyalty within the organization?\n\n# Analysis objectives\n\n1.  To understand what factors are important in influencing customer loyalty.\n2.  To understand which aspects the organization should invest in to improve customer loyalty.\n\n# Methodology\n\nThe financial services company carried out a survey. Customers who had interacted with a salesperson were asked to evaluate specific elements of their competence. They were also asked to express their likelihood of reinvesting in the company and to specify the potential amount of their reinvestment. The final question concerned the salesperson’s gender.\n\n# Data collection method\n\nThe survey included seven questions.\n\n::: {.panel-tabset group=\"language\"}\n### Salesperson competencies\n\nFour were specifically related to key salesperson competency elements:\n\n1.  The salesperson understanding your needs.\n\n2.  The salesperson seems confident.\n\n3.  The salesperson has a recommendation.\n\n4.  The salesperson is knowledgeable.\n\nThe customers were asked to grade the salesperson on a scale of 1 to 5, where 1 was ‘very dissatisfied’ and 5 was ‘very satisfied’.\n\n### Customer Loyalty\n\nTwo question related to loyalty and asked customers to put themselves on a scale of 1 to 5 where:\n\n::: columns\n::: {.column width=\"50%\"}\n5 Likelihood of reinvesting **(Custloyalty)**:\n\n1.  Definitely going to go elsewhere with my investments.\n\n2.  Thinking about going elsewhere with my money.\n\n3.  Not sure about where I will place my future investments.\n\n4.  Thinking about investing here again.\n\n5.  Definitely will invest here again.\n:::\n\n::: {.column width=\"50%\"}\n6 How much they may or may not reinvest **(InvestMore)**:\n\n1.  Definitely will not invest more than now here.\n\n2.  Unlikely to invest more than now here.\n\n3.  Planning to invest 0–50 per cent more than now in this organization.\n\n4.  Planning to invest 50–100 per cent more in this organization.\n\n5.  Going to double my investment or more in this organization.\n:::\n:::\n\n### Gender\n\nThe final question was about the gender of the sales person.\n\n7 Sex of sales person: 1 = female; 2 = male.\n:::\n\n# Data preparation\n\n## Load packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggtext)\nsource(\"helper_functions.R\")\nsource(\"theme_msd.R\")\nlibrary(janitor)\n```\n:::\n\n\n## Data Set[^2]\n\n[^2]: Data available [here](https://www.koganpage.com/hr-learning-development/predictive-hr-analytics-9780749484446)\n\n::: {.panel-tabset group=\"language\"}\n### Read data\n\nThe data set includes responses from 2,507 customers and 8 variables.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 2,507\nColumns: 8\n$ Sat1             <dbl> 1, 2, 3, 3, NA, 3, 4, 1, 4, 3, 4, 3, 4, 5, 3, 3, 4, 4…\n$ Sat2             <dbl> 1, 3, 5, 4, NA, 3, 4, 2, 5, 4, 4, 4, 4, 5, 4, 4, 4, 4…\n$ Sat3             <dbl> 1, 3, 4, 4, NA, 3, 4, 1, NA, 3, 4, 3, 3, 4, 5, 3, 4, …\n$ Sat4             <dbl> 3, 3, 5, 3, NA, 3, 5, 1, 5, 3, 4, 3, 4, 5, 4, 4, 4, 4…\n$ CustSatMean      <dbl> 1.50, 2.75, 4.25, 3.50, NA, 3.00, 4.25, 1.25, 4.67, 3…\n$ Custloyalty      <dbl> 4, 2, 2, 3, 5, 3, 4, 1, 3, 3, 4, 4, 4, 4, 1, 4, 4, 4,…\n$ INvestMore       <dbl> 3, 1, 3, 3, 3, 3, 2, 1, 3, NA, 2, 3, 3, 3, 3, 2, NA, …\n$ SexOfSalesperson <dbl> 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…\n```\n\n\n:::\n:::\n\n\n### Scan data\n\nAll variables in the data set are numeric.\\\nFor each variable, there are missing values (NAs).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nskimr::skim(cssurvey_raw)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |             |\n|:------------------------|:------------|\n|Name                     |cssurvey_raw |\n|Number of rows           |2507         |\n|Number of columns        |8            |\n|_______________________  |             |\n|Column type frequency:   |             |\n|numeric                  |8            |\n|________________________ |             |\n|Group variables          |None         |\n\n\n**Variable type: numeric**\n\n|skim_variable    | n_missing| complete_rate| mean|   sd| p0| p25|  p50| p75| p100|hist  |\n|:----------------|---------:|-------------:|----:|----:|--:|---:|----:|---:|----:|:-----|\n|Sat1             |       128|          0.95| 3.47| 1.04|  1|   3| 4.00|   4|    5|▁▃▇▇▃ |\n|Sat2             |       124|          0.95| 3.79| 0.95|  1|   3| 4.00|   4|    5|▁▁▅▇▅ |\n|Sat3             |       142|          0.94| 3.43| 1.10|  1|   3| 4.00|   4|    5|▂▃▇▇▅ |\n|Sat4             |       450|          0.82| 3.59| 0.98|  1|   3| 4.00|   4|    5|▁▂▆▇▃ |\n|CustSatMean      |        66|          0.97| 3.56| 0.91|  1|   3| 3.67|   4|    5|▁▂▆▇▆ |\n|Custloyalty      |       338|          0.87| 3.80| 1.10|  1|   3| 4.00|   5|    5|▁▂▃▇▇ |\n|INvestMore       |       476|          0.81| 2.93| 0.82|  1|   3| 3.00|   3|    5|▁▁▇▂▁ |\n|SexOfSalesperson |       121|          0.95| 1.79| 0.41|  1|   2| 2.00|   2|    2|▂▁▁▁▇ |\n\n\n:::\n:::\n\n:::\n\n## Understanding data structure\n\n-   Data structure:\n    -   The dataset consists of 2.507 rows, as per the description provided by the data source.\n    -   It contains 8 variables. Seven of them represent the questions from the survey, and an additional variable calculates the mean value of the customer satisfaction survey responses.\n\n## Understanding variables\n\n::: {.panel-tabset group=\"language\"}\n### Data Dictionary\n\n| Variable         | Detail                                                                      | Unit    | Range |\n|-----------------|-----------------------|-----------------|-----------------|\n| Sat1             | The salesperson understanding your needs                                    | numeric | 1-5   |\n| Sat2             | The salesperson seems confident                                             | numeric | 1-5   |\n| Sat3             | The salesperson has a recommendation                                        | numeric | 1-5   |\n| Sat4             | The salesperson is knowledgeable                                            | numeric | 1-5   |\n| CustSatMean      | Value derived from mathematical operation (mean) <br> of customer responses | numeric | 1-5   |\n| Custloyalty      | Likelihood of reinvesting                                                   | numeric | 1-5   |\n| INvestMore       | How much they may or may not reinvest                                       | numeric | 1-5   |\n| SexOfSalesperson | Gender                                                                      | numeric | 1-2   |\n\n### Problems and Solutions\n\n| Variable                             | Problem                                                   | Solution             |\n|----------------------|-------------------------------|-------------------|\n| Sat1, Sat2, Sat3, Sat4               | variables'names are not meaningful                        | rename variables     |\n| CustSatMean, Custloyalty, INvestMore | inconsistent entries                                      | rename variables     |\n| All except CustSatMean               | variable type is not numeric; they are ordinal and binary | change variable type |\n| All except CustSatMean               | variable labels                                           | assign labels        |\n:::\n\n# Cleaning Data\n\n## Clean name and rename variables\n\n::: {.panel-tabset group=\"language\"}\n### Problem\n\nCustSatMean, Custloyalty, INvestMore have inconsistent entries (e.g. IN..More).\n\n### Solution\n\n-   Clean names and rename these variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# use janitor::clean_name()\n\n(cssurvey_clean <- cssurvey_raw|>\n   rename(invest_more = INvestMore,\n          cust_loyalty = Custloyalty)|>\n    clean_names())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2,507 × 8\n    sat1  sat2  sat3  sat4 cust_sat_mean cust_loyalty invest_more\n   <dbl> <dbl> <dbl> <dbl>         <dbl>        <dbl>       <dbl>\n 1     1     1     1     3          1.5             4           3\n 2     2     3     3     3          2.75            2           1\n 3     3     5     4     5          4.25            2           3\n 4     3     4     4     3          3.5             3           3\n 5    NA    NA    NA    NA         NA               5           3\n 6     3     3     3     3          3               3           3\n 7     4     4     4     5          4.25            4           2\n 8     1     2     1     1          1.25            1           1\n 9     4     5    NA     5          4.67            3           3\n10     3     4     3     3          3.25            3          NA\n# ℹ 2,497 more rows\n# ℹ 1 more variable: sex_of_salesperson <dbl>\n```\n\n\n:::\n:::\n\n:::\n\n## Assign labels and rename variables\n\n::: {.panel-tabset group=\"language\"}\n### Problem\n\n-   The variable names ‘Sat1’, ‘Sat2’, ‘Sat3’, and ‘Sat4’ lack clarity. Although they are numeric in the data set, the data source classifies them as ordinal variables.\n\n-   The variable ‘sex_of_salesperson’ could be more appropriately named as ‘gender’.\n\n### Solution\n\n-   Create new variables based on the existing variables, rename variables, assign labels, and change variable type in factor.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create new variables, assign labels, change variable type in factor\n\n(cssurvey_clean <- cssurvey_clean |>\n  mutate(undst_cust_need = factor(sat1,\n                         levels = c(1:5),\n                         labels = c(\"Very Dissatisfied\", \"Dissatisfied\", \"Neutral\", \"Satisfied\", \"Very Satisfied\")),\n         sales_confidence = factor(sat2,\n                         levels = c(1:5),\n                         labels = c(\"Very Dissatisfied\", \"Dissatisfied\", \"Neutral\", \"Satisfied\", \"Very Satisfied\")),\n         give_recomm = factor(sat3,\n                         levels = c(1:5),\n                         labels = c(\"Very Dissatisfied\", \"Dissatisfied\", \"Neutral\", \"Satisfied\", \"Very Satisfied\")),\n         product_know = factor(sat4,\n                         levels = c(1:5),\n                         labels = c(\"Very Dissatisfied\", \"Dissatisfied\", \"Neutral\", \"Satisfied\", \"Very Satisfied\")),\n         gender = factor(sex_of_salesperson,\n                           levels = c(1:2),\n                           labels = c(\"female\", \"male\"))))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2,507 × 13\n    sat1  sat2  sat3  sat4 cust_sat_mean cust_loyalty invest_more\n   <dbl> <dbl> <dbl> <dbl>         <dbl>        <dbl>       <dbl>\n 1     1     1     1     3          1.5             4           3\n 2     2     3     3     3          2.75            2           1\n 3     3     5     4     5          4.25            2           3\n 4     3     4     4     3          3.5             3           3\n 5    NA    NA    NA    NA         NA               5           3\n 6     3     3     3     3          3               3           3\n 7     4     4     4     5          4.25            4           2\n 8     1     2     1     1          1.25            1           1\n 9     4     5    NA     5          4.67            3           3\n10     3     4     3     3          3.25            3          NA\n# ℹ 2,497 more rows\n# ℹ 6 more variables: sex_of_salesperson <dbl>, undst_cust_need <fct>,\n#   sales_confidence <fct>, give_recomm <fct>, product_know <fct>, gender <fct>\n```\n\n\n:::\n:::\n\n\n### Confirm\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncssurvey_clean|>\n  skimr::skim()\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |               |\n|:------------------------|:--------------|\n|Name                     |cssurvey_clean |\n|Number of rows           |2507           |\n|Number of columns        |13             |\n|_______________________  |               |\n|Column type frequency:   |               |\n|factor                   |5              |\n|numeric                  |8              |\n|________________________ |               |\n|Group variables          |None           |\n\n\n**Variable type: factor**\n\n|skim_variable    | n_missing| complete_rate|ordered | n_unique|top_counts                              |\n|:----------------|---------:|-------------:|:-------|--------:|:---------------------------------------|\n|undst_cust_need  |       128|          0.95|FALSE   |        5|Sat: 828, Neu: 747, Ver: 393, Dis: 315  |\n|sales_confidence |       124|          0.95|FALSE   |        5|Sat: 1014, Neu: 620, Ver: 562, Dis: 125 |\n|give_recomm      |       142|          0.94|FALSE   |        5|Sat: 780, Neu: 717, Ver: 417, Dis: 313  |\n|product_know     |       450|          0.82|FALSE   |        5|Sat: 803, Neu: 648, Ver: 360, Dis: 183  |\n|gender           |       121|          0.95|FALSE   |        2|mal: 1884, fem: 502                     |\n\n\n**Variable type: numeric**\n\n|skim_variable      | n_missing| complete_rate| mean|   sd| p0| p25|  p50| p75| p100|hist  |\n|:------------------|---------:|-------------:|----:|----:|--:|---:|----:|---:|----:|:-----|\n|sat1               |       128|          0.95| 3.47| 1.04|  1|   3| 4.00|   4|    5|▁▃▇▇▃ |\n|sat2               |       124|          0.95| 3.79| 0.95|  1|   3| 4.00|   4|    5|▁▁▅▇▅ |\n|sat3               |       142|          0.94| 3.43| 1.10|  1|   3| 4.00|   4|    5|▂▃▇▇▅ |\n|sat4               |       450|          0.82| 3.59| 0.98|  1|   3| 4.00|   4|    5|▁▂▆▇▃ |\n|cust_sat_mean      |        66|          0.97| 3.56| 0.91|  1|   3| 3.67|   4|    5|▁▂▆▇▆ |\n|cust_loyalty       |       338|          0.87| 3.80| 1.10|  1|   3| 4.00|   5|    5|▁▂▃▇▇ |\n|invest_more        |       476|          0.81| 2.93| 0.82|  1|   3| 3.00|   3|    5|▁▁▇▂▁ |\n|sex_of_salesperson |       121|          0.95| 1.79| 0.41|  1|   2| 2.00|   2|    2|▂▁▁▁▇ |\n\n\n:::\n:::\n\n:::\n\n# Data Analysis\n\nIn order to achieve the objectives of the analysis, I will conduct a key driver analysis[^3]. One of the goals of this analysis is to understand the factors influencing customer loyalty. I will start by reviewing the survey response percentages in the customer data.\n\n[^3]: I learned about this analysis in the book [People Analytics For Dummies](https://www.amazon.com/Analytics-Dummies-Business-Personal-Finance/dp/1119434769) by Mike West\n\n## Percentage of Responses in the Customer Survey Data\n\nSurveyed customers expressed satisfaction and high satisfaction with the ‘The salesperson seems confident’. However, they were less satisfied with ‘The salesperson understanding your needs’ and ‘The salesperson has a recommendation’.\n\nThe company might want to address these two aspects that customers are less satisfied with.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get the column names of the initial dataset\ninitial_order <- colnames(cssurvey_clean)[9:12]\n\n\n# Calculate percentages for each category for each survey question\n\nkda <- cssurvey_clean |>\n  drop_na()|>\n  pivot_longer(cols = 9:12, names_to = \"question\", values_to = \"value\" )|>\n  mutate(question= factor(question,\n                          levels= initial_order))|>\n  count(question, value) |>\n  group_by(question)|>\n  mutate(prtc = round(n/sum(n) * 100),\n         prtc = ifelse(row_number() == n(), 100 - sum(prtc[-n()]), prtc)) |>\n  pivot_wider(id_cols = question, names_from = value, values_from = prtc)\n\nkda$question <- c(\"The salesperson \\nunderstanding your needs\",\n                 \"The salesperson \\nseems confident\",\n                 \"The salesperson \\nhas a recommendation\",\n                 \"The salesperson \\nis knowledgeable\")\n\nkda|>\n  kableExtra::kable(col.names = c(\"Question\", \"Very Dissatisfied\", \"Dissatisfied\", \"Neutral\", \"Satisfied\", \"Very Satisfied\"),\n                    align = \"lccccc\",\n                    caption = \"Customer Satisfaction with Salesperson Competencies (%)\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Customer Satisfaction with Salesperson Competencies (%)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Question </th>\n   <th style=\"text-align:center;\"> Very Dissatisfied </th>\n   <th style=\"text-align:center;\"> Dissatisfied </th>\n   <th style=\"text-align:center;\"> Neutral </th>\n   <th style=\"text-align:center;\"> Satisfied </th>\n   <th style=\"text-align:center;\"> Very Satisfied </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> The salesperson \nunderstanding your needs </td>\n   <td style=\"text-align:center;\"> 4 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 33 </td>\n   <td style=\"text-align:center;\"> 35 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> The salesperson \nseems confident </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 27 </td>\n   <td style=\"text-align:center;\"> 43 </td>\n   <td style=\"text-align:center;\"> 22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> The salesperson \nhas a recommendation </td>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:center;\"> 14 </td>\n   <td style=\"text-align:center;\"> 31 </td>\n   <td style=\"text-align:center;\"> 33 </td>\n   <td style=\"text-align:center;\"> 17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> The salesperson \nis knowledgeable </td>\n   <td style=\"text-align:center;\"> 3 </td>\n   <td style=\"text-align:center;\"> 9 </td>\n   <td style=\"text-align:center;\"> 33 </td>\n   <td style=\"text-align:center;\"> 39 </td>\n   <td style=\"text-align:center;\"> 16 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntheme_set(theme_msd() + theme(\n  axis.title.y = element_blank(),\n  axis.ticks.y = element_blank(),\n  axis.text.y = element_text(color = GRAY3, size = 10),\n  panel.border = element_blank(),\n  axis.line = element_line(),\n  axis.title.x = element_text(hjust = 0.03, color = GRAY6, size = 10),\n  axis.text.x = element_text(size = 8),\n  plot.subtitle = element_markdown(hjust = 0.65),\n  axis.line.y = element_blank()\n))\n\n\ndf <- kda |>\n  rename(Item = \"question\") |>\n  pivot_longer(cols = -Item, names_to = \"Answer\", values_to = \"Value\") |>\n  mutate(\n    Answer = factor(Answer, levels = c(\"Very Dissatisfied\", \"Dissatisfied\", \"Neutral\", \"Satisfied\", \"Very Satisfied\")),\n    Value = as.numeric(Value) /100\n  )\n\ndf$Answer <- fct_rev(df$Answer)\n\n\n\ncolor_scale <- c(\n  \"Very Dissatisfied\" = GRAY2,\n  \"Dissatisfied\" = GRAY2,\n  \"Neutral\" = GRAY9,\n  \"Satisfied\" = GRAY5,\n  \"Very Satisfied\" = GRAY5)\n\n\nformatted_subtitle <- paste0(\n  \"<span style='color:\", color_scale[1], \"'>**\", names(color_scale)[1], \"**</span>\",\n  \" | \",\n  \"<span style='color:\", color_scale[2], \"'>**\", names(color_scale)[2], \"**</span>\",\n  \" | \",\n  \"<span style='color:\", color_scale[3], \"'>**\", names(color_scale)[3], \"**</span>\",\n  \" | \",\n  \"<span style='color:\", color_scale[4], \"'>**\", names(color_scale)[4], \"**</span>\",\n  \" | \",\n  \"<span style='color:\", color_scale[5], \"'>**\", names(color_scale)[5], \"**</span>\"\n)\n\npt <- df |>\n  ggplot(aes(y = Item, x = Value, fill = Answer)) +\n  geom_bar(stat = \"Identity\", width = 0.65, color = \"white\") +\n  scale_fill_manual(values = color_scale, guide = \"none\") +\n  labs(\n    title = \"Customer Satisfaction with Salesperson Competencies \\n\",\n    subtitle = formatted_subtitle,\n    x = \"\\nPercent of total\"\n  ) +\n  scale_x_continuous(position = \"top\", \n                     breaks = seq(0,1,by = 0.2),\n                     labels = scales::percent_format(accuracy = 1)) +\n  lemon::coord_capped_cart(top = \"both\")\n\npt |>\n  save_and_show_plot(width = 6, height = 4, \"FIG01.png\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/data-viz-cust-sat-1.png){width=672}\n:::\n:::\n\n\n## Correlation\n\nAnother approach to analyzing the customer survey data is through correlation. Correlation is a statistical measure of the relationship between two variables, how they are interconnected.\n\nAmong the four questions on the survey, at this stage, I aim to identify which ones have the strongest correlation with the question related to customer loyalty: the likelihood of reinvestment.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Correlation for several pairs of variables\n     \ncor_cust_loyalty <- cssurvey_clean |>\n  select(sat1, sat2, sat3, sat4, cust_loyalty)|>\n  cor(method = \"spearman\",\n      use = \"pairwise.complete.obs\")|>\n  round(digits = 2)\n\nsurvey_quest = c(\"The salesperson understanding your needs\",\n                 \"The salesperson seems confident\",\n                 \"The salesperson has a recommendation\",\n                 \"The salesperson is knowledgeable\")\n\n                        \ncor_to_cust_loyalty = c(0.49, 0.37, 0.49, 0.40)\n                            \n(cor_matrix <- tibble(survey_quest, cor_to_cust_loyalty)|>\n    arrange(desc(cor_to_cust_loyalty))|>\n  kableExtra::kable(col.names = c(\"Survey Question\", \"Correlation to \\nCustomer Loyalty\"),\n                    align = \"lr\",\n                    caption = \"Correlation of survey questions to customer loyalty\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Correlation of survey questions to customer loyalty</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Survey Question </th>\n   <th style=\"text-align:right;\"> Correlation to \nCustomer Loyalty </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> The salesperson understanding your needs </td>\n   <td style=\"text-align:right;\"> 0.49 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> The salesperson has a recommendation </td>\n   <td style=\"text-align:right;\"> 0.49 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> The salesperson is knowledgeable </td>\n   <td style=\"text-align:right;\"> 0.40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> The salesperson seems confident </td>\n   <td style=\"text-align:right;\"> 0.37 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n‘The salesperson understanding your needs’ , ‘The salesperson has a recommendation’ , and 'The salesperson is knowledgeable' are the most highly correlated to the question related to loyalty (0.49, respectively 0.40). The company might see these areas to focus in its efforts to improve customer loyalty.\n\n## Consolidating the Percentage and Correlation\n\nIn this step, I will integrate the customer satisfaction questions and their correlation to customer loyalty into a unified view for enhanced insights. To calculate the customer's importance of loyalty, I calculated the percentage of dissatisfied and very dissatisfied customers in a single metric, percent dissatisfaction. The 'Customer Loyalty Importance' is a calculated metric that combines percent dissatisfaction and the correlation to customer loyalty in one measure (see the table below). It allows us to rank survey questions by importance.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# we need to consolidate data from \"kda\" data set and \"cor_matrix\" data set\n\n# define cor_matrix as data frame\n\ncor_matrix <- as.data.frame(cor_matrix)\n\ncor_matrix <- tibble(survey_quest, cor_to_cust_loyalty)\n\n\nkda_cor <- bind_cols(kda, cor_matrix)\n  \n            \nkda_cor <- kda_cor |>\n  mutate(percent_dissatisfied = Dissatisfied + `Very Dissatisfied`,\n         percent_satisfied = Satisfied + `Very Satisfied`,\n         percent_neutral = Neutral) |>\n  group_by(percent_dissatisfied, cor_to_cust_loyalty) |>\n  mutate(cust_loyalty_importance = percent_dissatisfied*cor_to_cust_loyalty)|>\n  ungroup()\n \n\nkda_consolidate <- kda_cor |>\n  select(question, percent_dissatisfied, cor_to_cust_loyalty, cust_loyalty_importance)|>\n  arrange(desc(cust_loyalty_importance))|>\n  kableExtra::kable(col.names = c(\"Survey Question\", \"Percent Dissatisfaction\", \"Correlation to \\nCustomer Loyalty\", \"Customer Loyalty \\nImportance\"),\n                    align = \"lrrr\",\n                    caption = \"Customer Satisfaction items ranked by importance\")\n  \nkda_consolidate\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Customer Satisfaction items ranked by importance</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Survey Question </th>\n   <th style=\"text-align:right;\"> Percent Dissatisfaction </th>\n   <th style=\"text-align:right;\"> Correlation to \nCustomer Loyalty </th>\n   <th style=\"text-align:right;\"> Customer Loyalty \nImportance </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> The salesperson \nhas a recommendation </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:right;\"> 0.49 </td>\n   <td style=\"text-align:right;\"> 9.31 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> The salesperson \nunderstanding your needs </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 0.49 </td>\n   <td style=\"text-align:right;\"> 8.82 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> The salesperson \nis knowledgeable </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 0.40 </td>\n   <td style=\"text-align:right;\"> 4.80 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> The salesperson \nseems confident </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 0.37 </td>\n   <td style=\"text-align:right;\"> 2.96 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nWhat is the data from the table telling us?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntheme_set(theme_msd() + theme(\n  axis.title.y = element_blank(),\n  axis.ticks.y = element_blank(),\n  axis.text.y = element_text(color = GRAY3, size = 10),\n  panel.border = element_blank(),\n  axis.line = element_line(),\n  axis.title.x = element_text(hjust = 0.03, color = GRAY6, size = 9),\n  axis.text.x = element_text(color = GRAY3, size = 10),\n  plot.subtitle = element_markdown(hjust = 0),\n  axis.line.y = element_blank()\n))\n\n\nkda_consolidate_plot <- kda_cor |>\n  mutate(question = fct_reorder(question, cust_loyalty_importance))|>\n  ggplot(aes(x = cust_loyalty_importance, y = question))+\n  geom_bar(stat = \"identity\", width = 0.6, color = GRAY2)+\n  geom_text(aes(label = cust_loyalty_importance), hjust = -0.15, size = 3.5)+\n  labs(\n    title = \"The sales person having a recommendation and understanding customers \\nneeds are the issues that require some improvments \\n\",\n    subtitle = \"\",\n    x = \"Customer Loyalty Importance\"\n  )\n  \n  \nkda_consolidate_plot |>\n  save_and_show_plot(width = 6.5, height = 4, \"FIG02.png\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## Key Driver Analysis Resuts\n\nThe findings of the key driver analysis are presented below in a key driver quadrant. It allows us to see the two intersecting information points: the correlation of the four survey questions to customer loyalty, our chosen indicator to understand (axis x), and the satisfaction of customers' responses (axis y).\n\nThe survey questions are divided into three categories:\n\n - **Improve Weakness**:  The high correlation to customer loyalty (0.49) and the low percentages of customer satisfaction (dissatisfied and very dissatisfied) put the questions \"the salesperson has a recommendation\" (19) and \"the salesperson understanding your needs\" (18) in the lower right quadrant of the key driver analysis chart. On the upper side of this quadrant, it is important to note the significant percentage of neutral responses for these two questions.\n \n - **Leverage Great**: The high correlation to customer loyalty (0.49) and the high percentages of customer satisfaction (satisfied and very satisfied) put the questions \"the salesperson has a recommendation\" (50) and \"the salesperson understands your needs\" (49) in the upper right quadrant of the key driver analysis chart.\n \n - **Disregard**: In the rest of the survey questions, there is a range of satisfied and dissatisfied customer responses, but these questions are not as important concerning customer loyalty as the other two questions are. Therefore, these are not considered aspects the organization should focus on investing in to improve customer loyalty.\n \n::: callout-important\n \nKey driver analysis explores a wide range of measures to uncover what is most important in influencing the chosen objective. Key driver analysis helps you understand where to focus your energy and resources to obtain the results you are looking for.\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(glue)\nlibrary(grid)\n\n# Data ----\n# |- KDA Quadrant ----\n\n# First, I organize columns and rows in the data frame to make easier \n# to work with. I made a column \"sum_satisfaction\" with 3 categories where\n# I summed up the percentage of categories satisfied and very satisfied, dissatisfied and very dissatisfied and neutral to keep the plot simple to visualize\n\nkda_quadrant <- kda_cor |>\n    pivot_longer(cols = 2:6, names_to = \"satisfaction\", values_to = \"score\")\n\nkda_quadrant <- kda_quadrant|>\n  pivot_longer(cols = c(4:6), names_to = \"sum_satisfaction\", values_to = \"percent_score\")\n\n# Set the theme for the plot\n\ntheme_set(theme_msd()+ theme(\n  axis.text.y = element_text(color = GRAY6, size = 9),\n  axis.title.x = element_text(color = GRAY6, size = 10, margin = margin(6, 0, 15, 0, \"pt\")),\n  axis.title.y = element_text(color = GRAY6, size = 10),\n  axis.text.x = element_text(color = GRAY6, size = 9, margin = margin(0, 6, 0, 15, \"pt\"))\n))\n\n# Set seed for reproducible plot\n\nset.seed(123)\n\n\n# Plot ----\n# |- Palette ----\nsurvey_quest_palette <- list(\"The salesperson has a recommendation\" = \"#1A242F\",\n                             \"The salesperson understanding your needs\" = \"#94989D\",\n                             \"The salesperson seems confident\" = \"#1A242F\",\n                             \"The salesperson is knowledgeable\" = \"#1A242F\",\n                             \"dark_text\" = \"#1A242F\",\n                             \"light_text\" = \"#94989D\")\n\n# |- Shape ----\n\nsurvey_quest_shape <- list(\"The salesperson has a recommendation\" = 22,\n                             \"The salesperson understanding your needs\" = 21,\n                             \"The salesperson seems confident\" = 0,\n                             \"The salesperson is knowledgeable\" = 1)\n\n# Create text grobs for the labels with a specific font size and color\n\nlabel1 <- textGrob(\"Very Dissatisfied\", rot = 90, gp = gpar(fontsize = 9, col = GRAY6) )\nlabel2 <- textGrob(\"Neutral\", rot = 90, gp = gpar(fontsize = 9, col = GRAY6))\nlabel3 <- textGrob(\"Very Satisfied\", rot = 90, gp = gpar(fontsize = 9, col = GRAY6))\nlabel4 <- textGrob(\"Low\", gp = gpar(fontsize = 9, col = GRAY6))\nlabel5 <- textGrob(\"High\", gp = gpar(fontsize = 9, col = GRAY6))\n\n\n\n# | Quadrant Plot ----\n# | - Quadrant Base Panel ----\n\nquadrant_base <- kda_quadrant|>\n  ggplot(aes(x = cor_to_cust_loyalty,\n             y = percent_score))+\n  scale_x_continuous(expand = c(0,0),limits = c(0.3,0.6))+\n  scale_y_continuous(expand = c(0,0),\n                     limits = c(0,80),\n                     breaks = c(0, 30, 50, 80), \n                     labels = c(\"0\" = \"0\", \"30\" = \"30%\", \"50\" = \"50%\", \"80\" = \"80%\"))+\n\n # Add the labels to the plot using annotation_custom()\n   \n \n  annotation_custom(grob = label1, xmin = 0.292, xmax = 0.292, ymin = 9, ymax = 9) +\n  annotation_custom(grob = label2, xmin = 0.292, xmax = 0.292, ymin = 36, ymax = 36) +\n  annotation_custom(grob = label3, xmin = 0.292, xmax = 0.292, ymin = 65, ymax = 65) +\n  annotation_custom(grob = label4, ymin = -2.5, ymax = -2.5, xmin = 0.35, xmax = 0.35)+\n  annotation_custom(grob = label5, ymin = -2.5, ymax = -2.5, xmin = 0.55, xmax = 0.55)+ \n  coord_cartesian(clip = \"off\")+\n  theme(axis.line = element_blank())\n \n   \n\n\n# | - Quadrant Chart ----\n\n# Set axis labels and title\n\nlabelled_quadrant <-  quadrant_base +\n    labs(x = \"Correlation to customer loyalty\",\n         y = \"Customer satisfaction survey\",\n        title = \"Customer Loyalty Key Driver Report\\n\")+\n   theme(axis.title.x = element_text(hjust = 0.5,\n                                     vjust = 4,\n                                     face = \"bold\"),\n         axis.title.y = element_text(hjust = 0.5,\n                                     vjust = 0,\n                                     face = \"bold\"),\n        plot.title = element_text(color = GRAY2, size= 12),\n        plot.title.position = \"plot\"\n         )+\n \n\n  \n# add four rectangle type of annotations to fill the four quadrant areas\n# create a border and split lines for the quadrant chart\n  \n  annotate(\"rect\", xmin = 0.45, xmax = 0.60, ymin = 40, ymax = 80, fill= \"#F8F9F9\")+\n  annotate(\"rect\", xmin = 0.3, xmax = 0.60, ymin = 0, ymax = 80 , fill= \"#F8F9F9\")+\n  annotate(\"rect\", xmin = 0.45, xmax = 0.60, ymin = 40, ymax = 80, fill= \"white\")+\n  annotate(\"rect\", xmin = 0.3, xmax = 0.60, ymin = 0, ymax = 80, fill= \"white\")+\n  theme(panel.border = element_rect(colour = \"lightgrey\", fill = NA, linewidth = 3))+\n  geom_hline(yintercept= 40, color = \"lightgrey\", linewidth =1.5)+\n  geom_vline(xintercept= 0.45, color = \"lightgrey\", linewidth =1.5) +\n          \n# add label to quadrant area\n\n  geom_label(aes(x = 0.375,\n                 y = 77,\n                 label = \"DISREGARD\"),\n             label.padding = unit(2, \"mm\"),\n             fill = \"lightgrey\",\n             color = \"white\")+\n  geom_label(aes(x = 0.525,\n                 y = 77,\n                 label = \"LEVERAGE GREAT\"),\n             label.padding = unit(2, \"mm\"),\n             fill = \"lightgrey\",\n             color = \"white\")+\n  geom_label(aes(x = 0.525,\n                 y = 3,\n                 label = \"IMPROVE WEAKNESS\"),\n             label.padding = unit(2, \"mm\"),\n             fill = \"lightgrey\",\n             color = \"white\")+\n  \n# draw the questions survey to the chart with the position corresponding to their “customer satisfaction percent” value and “correlation to customer” value.\n  \n   geom_jitter(aes(x = cor_to_cust_loyalty,\n             y = percent_score,\n             color = survey_quest,\n             shape = survey_quest,\n             fill = survey_quest),\n         size = 5,\n         alpha = 0.8)+\n  theme( legend.position = \"top\",\n         legend.box = \"vertical\",\n         legend.margin = margin(unit(c(0,-0.45,0,0), \"cm\")),\n         legend.title = element_blank(),\n         legend.text = element_text(color = GRAY6, size = 9)) +\n  guides(shape = guide_legend(nrow = 2, byrow = TRUE),\n         fill = guide_legend(nrow = 2, byrow = TRUE),\n         color = guide_legend(nrow = 2, byrow = TRUE))+\n  scale_colour_manual(values = survey_quest_palette) +\n  scale_shape_manual(values = survey_quest_shape) +\n  scale_fill_manual(values = survey_quest_palette)\n   \n\n\nlabelled_quadrant\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n# Recommendation\n\nTo improve customer loyalty, the company could consider:\n\n - Improving salespeople’s ability to understand customer needs. This may include active listening, asking relevant questions, and maintaining accurate records.\n - Providing training for sales staff on making informed recommendations. This would likely result in a positive return on investment.\n - Identifying employees skilled at understanding and advising customers from raw data and sharing these skills within the team could also be beneficial.\n - Investigate more about what happens to clients who declare themselves neutral and how to convert them into satisfied customers.\n\n# Summary\n\nIn this post, I shared with you my key driver analysis. Here are the steps I followed:\n\n1.  First, I decided what I wanted to understand: What are the key factors influencing customer loyalty within the organization?\n\n2.  From the data available, I selected the measure to understand: customer loyalty (likelihood of reinvesting).\n\n3.  Understand the data.\n\n4.  Clean the data.\n\n5.  Analyze survey data, report the percentage of responses, and run a correlation to establish the strength of the relationship between potential factors and customer loyalty.\n\n6.  Use the correlation coefficient and the percentage of satisfied and dissatisfied responses to analyze the data.\n\n7.  Consider the strength of each factor’s relationship with customer loyalty and current company performance on those factors to focus on actions that will have the most impact.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}