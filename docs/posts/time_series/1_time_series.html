<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.4">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Cozmina Secula">
<meta name="dcterms.date" content="2024-07-03">
<meta name="description" content="Analyzing time series data and looking for trends.">

<title>Making sense of data â€“ Time Series Analysis (Part I)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../../site_libs/datatables-binding-0.30/datatables.js"></script>
<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Making sense of data - Time Series Analysis (Part I)">
<meta property="og:description" content="Analyzing time series data and looking for trends.">
<meta property="og:site_name" content="Making sense of data">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/cozminasecula/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/CozminaSecula"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:cozmina.secula@gmail.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Time Series Analysis (Part I)</h1>
                  <div>
        <div class="description">
          Analyzing time series data and looking for trends.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">time series</div>
                <div class="quarto-category">trends</div>
                <div class="quarto-category">data analysis</div>
                <div class="quarto-category">data visualization</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Cozmina Secula </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 3, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#subcategories-of-retail-sales" id="toc-subcategories-of-retail-sales" class="nav-link active" data-scroll-target="#subcategories-of-retail-sales">Subcategories of retail sales</a></li>
  <li><a href="#total-retail-and-food-services-in-us" id="toc-total-retail-and-food-services-in-us" class="nav-link" data-scroll-target="#total-retail-and-food-services-in-us">Total retail and food services in US</a>
  <ul class="collapse">
  <li><a href="#monthly-retail-and-food-services-in-us" id="toc-monthly-retail-and-food-services-in-us" class="nav-link" data-scroll-target="#monthly-retail-and-food-services-in-us">Monthly <code>Retail and Food Services</code> in US</a></li>
  <li><a href="#how-do-the-retail-and-food-services-sales-look-by-year" id="toc-how-do-the-retail-and-food-services-sales-look-by-year" class="nav-link" data-scroll-target="#how-do-the-retail-and-food-services-sales-look-by-year">How do the <code>retail and food services</code> sales look by year?</a></li>
  </ul></li>
  <li><a href="#comparing-yearly-sales-of-new-car-dealers-with-used-car-dealers" id="toc-comparing-yearly-sales-of-new-car-dealers-with-used-car-dealers" class="nav-link" data-scroll-target="#comparing-yearly-sales-of-new-car-dealers-with-used-car-dealers">Comparing yearly sales of <code>new car dealers</code> with <code>used car dealers</code></a></li>
  <li><a href="#during-the-past-few-decades-how-have-sales-of-new-and-used-cars-dealers-varied-in-dollars-and-percent" id="toc-during-the-past-few-decades-how-have-sales-of-new-and-used-cars-dealers-varied-in-dollars-and-percent" class="nav-link" data-scroll-target="#during-the-past-few-decades-how-have-sales-of-new-and-used-cars-dealers-varied-in-dollars-and-percent">During the past few decades, how have sales of <code>new and used cars dealers</code> varied in dollars and percent?</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">



    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Translate Widget</title>


    <div id="google_translate_element"></div>
    <script type="text/javascript">
        function googleTranslateElementInit() {
            new google.translate.TranslateElement(
                {pageLanguage: 'en'},
                'google_translate_element'
            );
        }
    </script>
    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>









<p><br></p>
<p>In this post, I will practice a few examples of time series analysis inspired by the book <a href="https://www.amazon.com/SQL-Data-Analysis-Techniques-Transforming/dp/1492088781">SQL for Data Analysis: Advanced Techniques for Transforming Data into Insights</a> using Retail and Food Services Sales data from this <a href="https://github.com/cathytanimura/sql_book/tree/master/Chapter%203:%20Time%20Series%20Analysis">source</a>. The data source, <a href="https://www.census.gov/retail/index.html#mrts">Monthly Retail Trade Report: Retail and Food Services Sales</a>, includes monthly total sales and sales for different subcategories of retail sales from 1992 to 2020. It is an Excel file that I chose to import into PostgreSQL and use SQL to retrieve the data.</p>
<p>The purpose of these examples is to practice analyzing time series data. The data will be analyzed in SQL and graphed in R to visualize trends by month and year. First, I will look at the total monthly retail and food services sales, then I will compare the sales of two subcategories from the dataset: sales at new car dealers and sales at used car dealers, across the same time range.</p>
<section id="prerequisites" class="level4">
<h4 class="anchored" data-anchor-id="prerequisites">Prerequisites</h4>
<p>Load the R packages I need.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>sleep_default <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"../theme/theme_ts.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="connect-to-the-database" class="level4">
<h4 class="anchored" data-anchor-id="connect-to-the-database">Connect to the database</h4>
<p>I will use R to connect to the PostgreSQL database to access and query the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(RPostgres<span class="sc">::</span><span class="fu">Postgres</span>(),</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dbname =</span> <span class="st">'training_center'</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">host =</span> <span class="st">'localhost'</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">port =</span> <span class="dv">5432</span>, </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">user =</span> <span class="fu">Sys.getenv</span>(<span class="st">"DEFAULT_POSTGRES_USER_NAME"</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">password =</span> <span class="fu">Sys.getenv</span>(<span class="st">"DEFAULT_POSTGRES_PASSWORD"</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bigint =</span> <span class="st">"integer"</span>) <span class="co"># change integer64 to integer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The fields used from the dataset for analysis are:</p>
<ul>
<li><code>sales_month</code>(month and year)</li>
<li><code>kind_of_business</code>(details of subcategories of retail sales)</li>
<li><code>sales</code> (sales figures in millions of US dollars).</li>
</ul>
<p>The data spans from January 1992 to December 2020.</p>
</section>
<section id="subcategories-of-retail-sales" class="level3">
<h3 class="anchored" data-anchor-id="subcategories-of-retail-sales">Subcategories of retail sales</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>rs_subcategories <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="st">    rs.kind_of_business </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM training_data.retail_sales rs </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY rs.kind_of_business ;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>rs_subcategories_tbl <span class="ot">&lt;-</span> (<span class="fu">dbGetQuery</span>(con, rs_subcategories))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8cfaefdb80545f795971" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8cfaefdb80545f795971">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65"],["All other gen. merchandise stores","All other home furnishings stores","Automobile and other motor vehicle dealers","Automobile dealers","Automotive parts, acc., and tire stores","Beer, wine, and liquor stores","Book stores","Building mat. and garden equip. and supplies dealers","Building mat. and supplies dealers","Clothing and clothing access. stores","Clothing stores","Department stores","Department stores(excl. discount department stores)","Discount dept. stores","Drinking places","Electronic shopping and mail-order houses","Electronics and appliance stores","Electronics stores","Family clothing stores","Floor covering stores","Food and beverage stores","Food services and drinking places","Fuel dealers","Full service restaurants","Furniture and home furnishings stores","Furniture stores","Furniture, home furn, electronics, and appliance stores","GAFO(1)","Gasoline stations","General merchandise stores","Gift, novelty, and souvenir stores","Grocery stores","Hardware stores","Health and personal care stores","Hobby, toy, and game stores","Home furnishings stores","Household appliance stores","Jewelry stores","Limited service eating places","Men's clothing stores","Miscellaneous store retailers","Motor vehicle and parts dealers","New car dealers","Nonstore retailers","Office supplies and stationery stores","Office supplies, stationery, and gift stores","Other clothing stores","Other general merchandise stores","Paint and wallpaper stores","Pharmacies and drug stores","Restaurants and other eating places","Retail and food services sales, total","Retail sales and food services excl gasoline stations","Retail sales and food services excl motor vehicle and parts","Retail sales and food services excl motor vehicle and parts and gasoline stations","Retail sales, total","Retail sales, total (excl. motor vehicle and parts dealers)","Shoe stores","Sporting goods stores","Sporting goods, hobby, musical instrument, and book stores","Supermarkets and other grocery (except convenience) stores","Used car dealers","Used merchandise stores","Warehouse clubs and superstores","Women's clothing stores"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>kind_of_business<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollY":true,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>Subcategories of retail sales dataset</p>
</div>
</div>
</section>
<section id="total-retail-and-food-services-in-us" class="level2">
<h2 class="anchored" data-anchor-id="total-retail-and-food-services-in-us">Total retail and food services in US</h2>
<p>I will start by looking at total monthly retail and food services sales.</p>
<section id="monthly-retail-and-food-services-in-us" class="level3">
<h3 class="anchored" data-anchor-id="monthly-retail-and-food-services-in-us">Monthly <code>Retail and Food Services</code> in US</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>monthly_rfs_sales <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="st">    rs.sales_month ,</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="st">    rs.sales </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="st">FROM training_data.retail_sales rs </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE upper(rs.kind_of_business) = upper('retail and food services sales, total');</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>monthly_rfs_sales_tbl <span class="ot">&lt;-</span> (<span class="fu">dbGetQuery</span>(con, monthly_rfs_sales))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(monthly_rfs_sales_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(monthly_rfs_sales_tbl, <span class="fu">aes</span>(<span class="at">x =</span> sales_month, <span class="at">y =</span> sales))<span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#222222"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">colour=</span><span class="st">"#333333"</span>)<span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>())<span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">'5 years'</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">date_format</span>(<span class="st">"%Y"</span>))<span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Monthly Retail and Food Services Sales in US'</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'1992 to 2020'</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">''</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'$MM Sales'</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ts</span>()<span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">18</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">15</span>, <span class="st">"pt"</span>)))</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1_time_series_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="3600"></p>
</figure>
</div>
</div>
</div>
<p>The trend shows an increase, with two periods of decreasing sales. However, it is not so clear at monthly level. We can aggregate the data from monthly to yearly to make the results easier to understand.</p>
</section>
<section id="how-do-the-retail-and-food-services-sales-look-by-year" class="level3">
<h3 class="anchored" data-anchor-id="how-do-the-retail-and-food-services-sales-look-by-year">How do the <code>retail and food services</code> sales look by year?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>yearly_rfs_sales <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="st">    date_part('year', rs.sales_month) AS year,</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="st">    sum(rs.sales) AS sales</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="st">FROM training_data.retail_sales rs </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE upper(rs.kind_of_business) = upper('retail and food services sales, total')</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY date_part('year', rs.sales_month);</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>yearly_rfs_sales_tbl <span class="ot">&lt;-</span> (<span class="fu">dbGetQuery</span>(con, yearly_rfs_sales))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-18256d1981b9657d55b5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-18256d1981b9657d55b5">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29"],[1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020],[2014102,2153095,2330235,2450628,2603794,2726131,2852956,3086990,3287537,3378906,3459077,3612457,3846605,4085746,4294359,4439733,4391580,4064476,4284968,4598302,4826390,5001763,5215656,5349487,5510186,5744810,6001623,6218002,6224399]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>year<\/th>\n      <th>sales<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollY":true,"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>Yearly Retail and Food Services Sales</p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>yearly_rfs_sales_tbl <span class="ot">&lt;-</span> yearly_rfs_sales_tbl <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(year, <span class="st">"-01-01"</span>)))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>(yearly_rfs_sales_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(yearly_rfs_sales_tbl, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> sales))<span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#222222"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">colour=</span><span class="st">"#333333"</span>)<span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>())<span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">'5 years'</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">date_format</span>(<span class="st">"%Y"</span>))<span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Yearly Retail and Food Services Sales in US 1992-2020'</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'After increasing over time, sales dropped in 2009 but then increased again  </span><span class="sc">\n</span><span class="st">over the next ten years. In 2020, sales were flat compared to 2019.'</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">''</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'$MM Sales'</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ts</span>()<span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">18</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">15</span>, <span class="st">"pt"</span>))</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">"text"</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2009-01-01"</span>, <span class="st">"2019-01-01"</span>)),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">4000000</span>, <span class="dv">6550000</span>),</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Financial </span><span class="sc">\n</span><span class="st"> crisis"</span>, <span class="st">"COVID-19</span><span class="sc">\n</span><span class="st">pandemic"</span>),</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">vjust =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>),</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">"#222222"</span>,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">6</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1_time_series_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="3600"></p>
</figure>
</div>
</div>
</div>
<p>For the next examples, I will look at sales at <code>new and used car dealers</code>, two of the subcategories included in the retail sales dataset.</p>
</section>
</section>
<section id="comparing-yearly-sales-of-new-car-dealers-with-used-car-dealers" class="level2">
<h2 class="anchored" data-anchor-id="comparing-yearly-sales-of-new-car-dealers-with-used-car-dealers">Comparing yearly sales of <code>new car dealers</code> with <code>used car dealers</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>new_used_car_sales <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(YEAR FROM rs.sales_month) AS year,</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">    rs.kind_of_business,</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">    sum(rs.sales) as sales</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">FROM training_data.retail_sales rs </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE upper(rs.kind_of_business) = upper('new car dealers') OR </span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st">      upper(rs.kind_of_business) = upper('used car dealers')</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY EXTRACT(YEAR FROM rs.sales_month), rs.kind_of_business</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY year;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>new_used_car_sales_tbl <span class="ot">&lt;-</span> (<span class="fu">dbGetQuery</span>(con, new_used_car_sales))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d1b473c2ed28e16aa6b4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d1b473c2ed28e16aa6b4">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58"],[1992,1992,1993,1993,1994,1994,1995,1995,1996,1996,1997,1997,1998,1998,1999,1999,2000,2000,2001,2001,2002,2002,2003,2003,2004,2004,2005,2005,2006,2006,2007,2007,2008,2008,2009,2009,2010,2010,2011,2011,2012,2012,2013,2013,2014,2014,2015,2015,2016,2016,2017,2017,2018,2018,2019,2019,2020,2020],["New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers"],[333801,24643,379522,27604,435661,32439,464642,37042,502340,41609,518972,45686,542559,50942,606167,55653,630123,57659,649413,58263,645759,60923,659205,63055,670553,67521,681947,71124,685622,75176,687707,79696,575593,73912,486565,65431,549473,71707,608788,75717,672550,80228,735374,83916,785142,90424,842120,98330,875596,105905,896014,112174,908505,114390,939551,119067,930265,124040]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>year<\/th>\n      <th>kind_of_business<\/th>\n      <th>sales<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollY":true,"columnDefs":[{"className":"dt-right","targets":[1,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>New and Used Car Yearly Sales</p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>new_used_car_sales_tbl <span class="ot">&lt;-</span> new_used_car_sales_tbl <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(year, <span class="st">"-01-01"</span>)))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>new_used_car_sales_tbl_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(new_used_car_sales_tbl, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> sales, <span class="at">color =</span> kind_of_business))<span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">colour=</span><span class="st">"#333333"</span>)<span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>())<span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">"5 years"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">label=</span> scales<span class="sc">::</span><span class="fu">date_format</span>(<span class="st">"%Y"</span>))<span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'New car dealers'</span> <span class="ot">=</span> <span class="st">"#222222"</span>, <span class="st">'Used car dealers'</span> <span class="ot">=</span> <span class="st">"#1380A1"</span> ))<span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Yearly New and Used Car Deales Sales in US 1992-2020'</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'Sales at new car dealers grew faster than sales at used car dealers. </span><span class="sc">\n</span><span class="st">Sales dropped during the financial crisis but increased again in the following years. </span><span class="sc">\n</span><span class="st">During the COVID-19 pandemic sales of new cars began to decline.'</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">''</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'$MM Sales'</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ts</span>()<span class="sc">+</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(),</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">18</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">15</span>, <span class="st">"pt"</span>)),</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'rect'</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2008-01-01"</span>, <span class="st">"2019-01-01"</span>)),</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2010-01-01"</span>, <span class="st">"2020-01-01"</span>)),</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="fu">c</span>(<span class="dv">750000</span>,<span class="dv">1000000</span>),</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">'#A6A6A5'</span>,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.1</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'text'</span>,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2007-01-01"</span>, <span class="st">"2017-06-01"</span>)),</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">460000</span>, <span class="dv">950000</span>),</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"2007â€“2008 financial crisis </span><span class="sc">\n</span><span class="st">2008-2010 automotive </span><span class="sc">\n</span><span class="st">industry crisis"</span>,</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>                <span class="st">"COVID-19 </span><span class="sc">\n</span><span class="st">crisis"</span>),</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">6</span>,</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a> (new_used_car_sales_tbl_plot <span class="ot">&lt;-</span> new_used_car_sales_tbl_plot <span class="sc">+</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2019-07-01"</span>), <span class="at">y =</span> <span class="dv">900000</span>, <span class="at">label =</span> <span class="st">"New /ncar"</span>), </span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>                <span class="at">vjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">"#222222"</span>, </span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.size =</span> <span class="cn">NA</span>, </span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>                <span class="at">family=</span><span class="st">"Microsoft Sans Serif"</span>, </span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2019-07-01"</span>), <span class="at">y =</span> <span class="dv">119000</span>, <span class="at">label =</span> <span class="st">"Used /ncar"</span>), </span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>                <span class="at">vjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">"#1380A1"</span>, </span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.size =</span> <span class="cn">NA</span>, </span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>                <span class="at">family=</span><span class="st">"Microsoft Sans Serif"</span>, </span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1_time_series_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="3600"></p>
</figure>
</div>
</div>
</div>
<p>As we saw, new car sales are considerably higher than used car sales, but what exactly are the values of new and used car dealersâ€™ sales as a percent of total monthly sales?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>new_and_used_car_sales_percent <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">    rs.sales_month,</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">    rs.kind_of_business,</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="st">    sum(rs.sales) AS category_sales,</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="st">    sum(sum(rs.sales)) OVER (PARTITION BY rs.sales_month) AS total_sales,</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="st">    round(sum(rs.sales) / sum(sum(rs.sales)) OVER (PARTITION BY rs.sales_month) * 100, 2) AS category_percent</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="st">FROM training_data.retail_sales rs </span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE rs.kind_of_business IN ('New car dealers', 'Used car dealers')</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY rs.sales_month, rs.kind_of_business</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY rs.sales_month;;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>new_and_used_car_sales_percent_tbl <span class="ot">&lt;-</span> (<span class="fu">dbGetQuery</span>(con, new_and_used_car_sales_percent))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b9c480010a28b9e5dba0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b9c480010a28b9e5dba0">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696"],["1992-01-01","1992-01-01","1992-02-01","1992-02-01","1992-03-01","1992-03-01","1992-04-01","1992-04-01","1992-05-01","1992-05-01","1992-06-01","1992-06-01","1992-07-01","1992-07-01","1992-08-01","1992-08-01","1992-09-01","1992-09-01","1992-10-01","1992-10-01","1992-11-01","1992-11-01","1992-12-01","1992-12-01","1993-01-01","1993-01-01","1993-02-01","1993-02-01","1993-03-01","1993-03-01","1993-04-01","1993-04-01","1993-05-01","1993-05-01","1993-06-01","1993-06-01","1993-07-01","1993-07-01","1993-08-01","1993-08-01","1993-09-01","1993-09-01","1993-10-01","1993-10-01","1993-11-01","1993-11-01","1993-12-01","1993-12-01","1994-01-01","1994-01-01","1994-02-01","1994-02-01","1994-03-01","1994-03-01","1994-04-01","1994-04-01","1994-05-01","1994-05-01","1994-06-01","1994-06-01","1994-07-01","1994-07-01","1994-08-01","1994-08-01","1994-09-01","1994-09-01","1994-10-01","1994-10-01","1994-11-01","1994-11-01","1994-12-01","1994-12-01","1995-01-01","1995-01-01","1995-02-01","1995-02-01","1995-03-01","1995-03-01","1995-04-01","1995-04-01","1995-05-01","1995-05-01","1995-06-01","1995-06-01","1995-07-01","1995-07-01","1995-08-01","1995-08-01","1995-09-01","1995-09-01","1995-10-01","1995-10-01","1995-11-01","1995-11-01","1995-12-01","1995-12-01","1996-01-01","1996-01-01","1996-02-01","1996-02-01","1996-03-01","1996-03-01","1996-04-01","1996-04-01","1996-05-01","1996-05-01","1996-06-01","1996-06-01","1996-07-01","1996-07-01","1996-08-01","1996-08-01","1996-09-01","1996-09-01","1996-10-01","1996-10-01","1996-11-01","1996-11-01","1996-12-01","1996-12-01","1997-01-01","1997-01-01","1997-02-01","1997-02-01","1997-03-01","1997-03-01","1997-04-01","1997-04-01","1997-05-01","1997-05-01","1997-06-01","1997-06-01","1997-07-01","1997-07-01","1997-08-01","1997-08-01","1997-09-01","1997-09-01","1997-10-01","1997-10-01","1997-11-01","1997-11-01","1997-12-01","1997-12-01","1998-01-01","1998-01-01","1998-02-01","1998-02-01","1998-03-01","1998-03-01","1998-04-01","1998-04-01","1998-05-01","1998-05-01","1998-06-01","1998-06-01","1998-07-01","1998-07-01","1998-08-01","1998-08-01","1998-09-01","1998-09-01","1998-10-01","1998-10-01","1998-11-01","1998-11-01","1998-12-01","1998-12-01","1999-01-01","1999-01-01","1999-02-01","1999-02-01","1999-03-01","1999-03-01","1999-04-01","1999-04-01","1999-05-01","1999-05-01","1999-06-01","1999-06-01","1999-07-01","1999-07-01","1999-08-01","1999-08-01","1999-09-01","1999-09-01","1999-10-01","1999-10-01","1999-11-01","1999-11-01","1999-12-01","1999-12-01","2000-01-01","2000-01-01","2000-02-01","2000-02-01","2000-03-01","2000-03-01","2000-04-01","2000-04-01","2000-05-01","2000-05-01","2000-06-01","2000-06-01","2000-07-01","2000-07-01","2000-08-01","2000-08-01","2000-09-01","2000-09-01","2000-10-01","2000-10-01","2000-11-01","2000-11-01","2000-12-01","2000-12-01","2001-01-01","2001-01-01","2001-02-01","2001-02-01","2001-03-01","2001-03-01","2001-04-01","2001-04-01","2001-05-01","2001-05-01","2001-06-01","2001-06-01","2001-07-01","2001-07-01","2001-08-01","2001-08-01","2001-09-01","2001-09-01","2001-10-01","2001-10-01","2001-11-01","2001-11-01","2001-12-01","2001-12-01","2002-01-01","2002-01-01","2002-02-01","2002-02-01","2002-03-01","2002-03-01","2002-04-01","2002-04-01","2002-05-01","2002-05-01","2002-06-01","2002-06-01","2002-07-01","2002-07-01","2002-08-01","2002-08-01","2002-09-01","2002-09-01","2002-10-01","2002-10-01","2002-11-01","2002-11-01","2002-12-01","2002-12-01","2003-01-01","2003-01-01","2003-02-01","2003-02-01","2003-03-01","2003-03-01","2003-04-01","2003-04-01","2003-05-01","2003-05-01","2003-06-01","2003-06-01","2003-07-01","2003-07-01","2003-08-01","2003-08-01","2003-09-01","2003-09-01","2003-10-01","2003-10-01","2003-11-01","2003-11-01","2003-12-01","2003-12-01","2004-01-01","2004-01-01","2004-02-01","2004-02-01","2004-03-01","2004-03-01","2004-04-01","2004-04-01","2004-05-01","2004-05-01","2004-06-01","2004-06-01","2004-07-01","2004-07-01","2004-08-01","2004-08-01","2004-09-01","2004-09-01","2004-10-01","2004-10-01","2004-11-01","2004-11-01","2004-12-01","2004-12-01","2005-01-01","2005-01-01","2005-02-01","2005-02-01","2005-03-01","2005-03-01","2005-04-01","2005-04-01","2005-05-01","2005-05-01","2005-06-01","2005-06-01","2005-07-01","2005-07-01","2005-08-01","2005-08-01","2005-09-01","2005-09-01","2005-10-01","2005-10-01","2005-11-01","2005-11-01","2005-12-01","2005-12-01","2006-01-01","2006-01-01","2006-02-01","2006-02-01","2006-03-01","2006-03-01","2006-04-01","2006-04-01","2006-05-01","2006-05-01","2006-06-01","2006-06-01","2006-07-01","2006-07-01","2006-08-01","2006-08-01","2006-09-01","2006-09-01","2006-10-01","2006-10-01","2006-11-01","2006-11-01","2006-12-01","2006-12-01","2007-01-01","2007-01-01","2007-02-01","2007-02-01","2007-03-01","2007-03-01","2007-04-01","2007-04-01","2007-05-01","2007-05-01","2007-06-01","2007-06-01","2007-07-01","2007-07-01","2007-08-01","2007-08-01","2007-09-01","2007-09-01","2007-10-01","2007-10-01","2007-11-01","2007-11-01","2007-12-01","2007-12-01","2008-01-01","2008-01-01","2008-02-01","2008-02-01","2008-03-01","2008-03-01","2008-04-01","2008-04-01","2008-05-01","2008-05-01","2008-06-01","2008-06-01","2008-07-01","2008-07-01","2008-08-01","2008-08-01","2008-09-01","2008-09-01","2008-10-01","2008-10-01","2008-11-01","2008-11-01","2008-12-01","2008-12-01","2009-01-01","2009-01-01","2009-02-01","2009-02-01","2009-03-01","2009-03-01","2009-04-01","2009-04-01","2009-05-01","2009-05-01","2009-06-01","2009-06-01","2009-07-01","2009-07-01","2009-08-01","2009-08-01","2009-09-01","2009-09-01","2009-10-01","2009-10-01","2009-11-01","2009-11-01","2009-12-01","2009-12-01","2010-01-01","2010-01-01","2010-02-01","2010-02-01","2010-03-01","2010-03-01","2010-04-01","2010-04-01","2010-05-01","2010-05-01","2010-06-01","2010-06-01","2010-07-01","2010-07-01","2010-08-01","2010-08-01","2010-09-01","2010-09-01","2010-10-01","2010-10-01","2010-11-01","2010-11-01","2010-12-01","2010-12-01","2011-01-01","2011-01-01","2011-02-01","2011-02-01","2011-03-01","2011-03-01","2011-04-01","2011-04-01","2011-05-01","2011-05-01","2011-06-01","2011-06-01","2011-07-01","2011-07-01","2011-08-01","2011-08-01","2011-09-01","2011-09-01","2011-10-01","2011-10-01","2011-11-01","2011-11-01","2011-12-01","2011-12-01","2012-01-01","2012-01-01","2012-02-01","2012-02-01","2012-03-01","2012-03-01","2012-04-01","2012-04-01","2012-05-01","2012-05-01","2012-06-01","2012-06-01","2012-07-01","2012-07-01","2012-08-01","2012-08-01","2012-09-01","2012-09-01","2012-10-01","2012-10-01","2012-11-01","2012-11-01","2012-12-01","2012-12-01","2013-01-01","2013-01-01","2013-02-01","2013-02-01","2013-03-01","2013-03-01","2013-04-01","2013-04-01","2013-05-01","2013-05-01","2013-06-01","2013-06-01","2013-07-01","2013-07-01","2013-08-01","2013-08-01","2013-09-01","2013-09-01","2013-10-01","2013-10-01","2013-11-01","2013-11-01","2013-12-01","2013-12-01","2014-01-01","2014-01-01","2014-02-01","2014-02-01","2014-03-01","2014-03-01","2014-04-01","2014-04-01","2014-05-01","2014-05-01","2014-06-01","2014-06-01","2014-07-01","2014-07-01","2014-08-01","2014-08-01","2014-09-01","2014-09-01","2014-10-01","2014-10-01","2014-11-01","2014-11-01","2014-12-01","2014-12-01","2015-01-01","2015-01-01","2015-02-01","2015-02-01","2015-03-01","2015-03-01","2015-04-01","2015-04-01","2015-05-01","2015-05-01","2015-06-01","2015-06-01","2015-07-01","2015-07-01","2015-08-01","2015-08-01","2015-09-01","2015-09-01","2015-10-01","2015-10-01","2015-11-01","2015-11-01","2015-12-01","2015-12-01","2016-01-01","2016-01-01","2016-02-01","2016-02-01","2016-03-01","2016-03-01","2016-04-01","2016-04-01","2016-05-01","2016-05-01","2016-06-01","2016-06-01","2016-07-01","2016-07-01","2016-08-01","2016-08-01","2016-09-01","2016-09-01","2016-10-01","2016-10-01","2016-11-01","2016-11-01","2016-12-01","2016-12-01","2017-01-01","2017-01-01","2017-02-01","2017-02-01","2017-03-01","2017-03-01","2017-04-01","2017-04-01","2017-05-01","2017-05-01","2017-06-01","2017-06-01","2017-07-01","2017-07-01","2017-08-01","2017-08-01","2017-09-01","2017-09-01","2017-10-01","2017-10-01","2017-11-01","2017-11-01","2017-12-01","2017-12-01","2018-01-01","2018-01-01","2018-02-01","2018-02-01","2018-03-01","2018-03-01","2018-04-01","2018-04-01","2018-05-01","2018-05-01","2018-06-01","2018-06-01","2018-07-01","2018-07-01","2018-08-01","2018-08-01","2018-09-01","2018-09-01","2018-10-01","2018-10-01","2018-11-01","2018-11-01","2018-12-01","2018-12-01","2019-01-01","2019-01-01","2019-02-01","2019-02-01","2019-03-01","2019-03-01","2019-04-01","2019-04-01","2019-05-01","2019-05-01","2019-06-01","2019-06-01","2019-07-01","2019-07-01","2019-08-01","2019-08-01","2019-09-01","2019-09-01","2019-10-01","2019-10-01","2019-11-01","2019-11-01","2019-12-01","2019-12-01","2020-01-01","2020-01-01","2020-02-01","2020-02-01","2020-03-01","2020-03-01","2020-04-01","2020-04-01","2020-05-01","2020-05-01","2020-06-01","2020-06-01","2020-07-01","2020-07-01","2020-08-01","2020-08-01","2020-09-01","2020-09-01","2020-10-01","2020-10-01","2020-11-01","2020-11-01","2020-12-01","2020-12-01"],["New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers","New car dealers","Used car dealers"],[24056,1744,25041,1990,28018,2177,27982,2601,28924,2171,30591,2207,29934,2251,28052,2087,28949,2016,29429,2149,26171,1667,26654,1583,25801,2022,26165,2199,31277,2526,32586,2564,32786,2309,34497,2393,34162,2485,33517,2287,32501,2167,32534,2339,31679,2253,32017,2060,29860,2199,31959,2432,39742,2669,38191,2782,37869,2638,39511,2769,36388,2774,38533,3119,37385,2887,36654,3136,35170,2564,34399,2470,32778,2709,33412,2833,41374,3296,38132,2998,42309,3180,43957,3303,39540,3492,42592,3445,38978,3223,38834,3074,37202,2931,35534,2558,36390,2871,40087,3451,44798,4046,42745,3879,46525,3727,43649,3538,43833,3571,44020,3511,41252,3221,43454,3526,38484,3262,37103,3006,38950,3377,40036,3834,45967,4089,44106,4115,45673,4022,45196,4088,46093,4066,46085,3864,43626,3741,44122,3822,38649,3294,40469,3374,39690,3681,39936,4154,47249,4523,47084,4400,48972,4356,51217,4723,46220,4535,44965,4476,44560,4138,46742,4535,41949,3730,43975,3691,42042,4115,45230,4597,53840,4921,50680,4824,53277,4950,54565,5047,54023,4895,55555,4892,51570,4509,49379,4516,47695,4292,48311,4095,47032,4381,53501,5327,59381,5434,51683,4841,57481,4986,57235,5161,52953,4989,56931,5089,52112,4860,50745,4574,46458,4089,44611,3928,47306,4648,49251,4917,56675,5359,52336,4991,58144,5390,57024,5169,54088,4906,58125,5142,48652,4291,65947,4903,52687,4444,49178,4103,48146,4802,49591,5226,54904,5212,54982,5260,55678,5342,55376,5199,60595,5229,63686,5542,51582,4855,52271,5143,47747,4736,51201,4377,49170,5209,47673,5477,56000,5877,55764,5572,59506,5586,58090,5324,61433,5466,61356,5494,55297,5072,53065,5014,48537,4528,53314,4436,47864,5053,50584,5538,60638,6055,55578,5564,59332,5882,57264,5548,60858,5773,59246,5948,57973,5546,53128,5785,50718,5481,57370,5348,47706,5803,50927,6480,61437,6602,58535,6036,59474,5955,65585,6018,69231,6080,62506,6419,53141,5684,47958,5597,49730,5325,55717,5125,50629,5811,51314,6245,62921,7009,56863,6470,61023,6638,60477,6522,61957,6371,63872,6653,55786,6204,53468,6146,51710,5634,55602,5473,50920,6089,53146,6625,63462,7276,57632,6734,63279,7186,59095,6850,59393,6781,64017,7310,55806,6591,56263,6583,51284,5957,53410,5714,49775,6544,51502,7182,57091,7291,53864,6940,55396,6683,49500,6653,50236,6286,51435,6226,44333,5662,39272,5432,34535,4452,38654,4561,36015,5544,35243,6088,40565,6017,39441,5652,41068,5442,42442,5654,45635,5477,49947,5748,37120,5195,40085,5199,36810,4654,42194,4761,37035,5127,37155,6300,49926,6580,47053,5957,48346,5857,46879,6195,49697,6183,48858,6288,45610,5971,45366,6123,43813,5604,49735,5522,43739,5976,46318,7295,55952,7661,51777,6446,51278,6260,51281,6460,51208,6348,52919,6438,50292,5951,49873,5710,48662,5530,55489,5642,47096,5889,52611,7728,61036,7757,54942,6811,60389,6667,56669,6658,56948,6411,61184,7237,54451,6383,54854,6450,53618,6167,58752,6070,53175,6766,54716,8397,63329,8250,61448,7411,65809,7190,62573,6970,66126,6963,68316,7269,58075,6243,60383,6682,58700,6183,62724,5592,54554,6065,56299,8022,69047,8564,66931,7601,71351,7695,65629,7542,69994,7657,72042,7936,63756,7584,64501,7933,61782,6822,69256,7003,60980,7435,59825,9092,73305,9331,70517,8969,74341,8544,71417,8337,74999,8377,76094,8353,70394,7689,69848,7911,65942,7193,74458,7099,62053,7638,67236,10269,75554,9947,73168,9093,74684,8490,73321,8896,75982,8743,79681,9287,73260,8421,70828,8792,70027,7864,79802,8465,65246,8497,67180,9598,79075,10955,72049,9237,78818,9726,75567,9778,76767,9527,79225,9632,76099,9265,74172,9139,72975,8594,78841,8226,67039,8836,66801,9923,82057,11259,73702,9543,81379,10096,77603,9777,77583,9788,81497,10081,72506,8951,75133,9104,73028,8656,80177,8376,66443,8828,66959,9675,82023,11856,76429,10345,83481,10549,77853,10078,82192,10255,87792,10357,75986,9404,79452,9696,78496,9355,82445,8669,71757,8971,74033,10567,59312,9273,50003,6403,77773,10707,81593,11966,84691,12413,86015,12191,85909,11071,87522,10956,79269,9954,92388,9568],[25800,25800,27031,27031,30195,30195,30583,30583,31095,31095,32798,32798,32185,32185,30139,30139,30965,30965,31578,31578,27838,27838,28237,28237,27823,27823,28364,28364,33803,33803,35150,35150,35095,35095,36890,36890,36647,36647,35804,35804,34668,34668,34873,34873,33932,33932,34077,34077,32059,32059,34391,34391,42411,42411,40973,40973,40507,40507,42280,42280,39162,39162,41652,41652,40272,40272,39790,39790,37734,37734,36869,36869,35487,35487,36245,36245,44670,44670,41130,41130,45489,45489,47260,47260,43032,43032,46037,46037,42201,42201,41908,41908,40133,40133,38092,38092,39261,39261,43538,43538,48844,48844,46624,46624,50252,50252,47187,47187,47404,47404,47531,47531,44473,44473,46980,46980,41746,41746,40109,40109,42327,42327,43870,43870,50056,50056,48221,48221,49695,49695,49284,49284,50159,50159,49949,49949,47367,47367,47944,47944,41943,41943,43843,43843,43371,43371,44090,44090,51772,51772,51484,51484,53328,53328,55940,55940,50755,50755,49441,49441,48698,48698,51277,51277,45679,45679,47666,47666,46157,46157,49827,49827,58761,58761,55504,55504,58227,58227,59612,59612,58918,58918,60447,60447,56079,56079,53895,53895,51987,51987,52406,52406,51413,51413,58828,58828,64815,64815,56524,56524,62467,62467,62396,62396,57942,57942,62020,62020,56972,56972,55319,55319,50547,50547,48539,48539,51954,51954,54168,54168,62034,62034,57327,57327,63534,63534,62193,62193,58994,58994,63267,63267,52943,52943,70850,70850,57131,57131,53281,53281,52948,52948,54817,54817,60116,60116,60242,60242,61020,61020,60575,60575,65824,65824,69228,69228,56437,56437,57414,57414,52483,52483,55578,55578,54379,54379,53150,53150,61877,61877,61336,61336,65092,65092,63414,63414,66899,66899,66850,66850,60369,60369,58079,58079,53065,53065,57750,57750,52917,52917,56122,56122,66693,66693,61142,61142,65214,65214,62812,62812,66631,66631,65194,65194,63519,63519,58913,58913,56199,56199,62718,62718,53509,53509,57407,57407,68039,68039,64571,64571,65429,65429,71603,71603,75311,75311,68925,68925,58825,58825,53555,53555,55055,55055,60842,60842,56440,56440,57559,57559,69930,69930,63333,63333,67661,67661,66999,66999,68328,68328,70525,70525,61990,61990,59614,59614,57344,57344,61075,61075,57009,57009,59771,59771,70738,70738,64366,64366,70465,70465,65945,65945,66174,66174,71327,71327,62397,62397,62846,62846,57241,57241,59124,59124,56319,56319,58684,58684,64382,64382,60804,60804,62079,62079,56153,56153,56522,56522,57661,57661,49995,49995,44704,44704,38987,38987,43215,43215,41559,41559,41331,41331,46582,46582,45093,45093,46510,46510,48096,48096,51112,51112,55695,55695,42315,42315,45284,45284,41464,41464,46955,46955,42162,42162,43455,43455,56506,56506,53010,53010,54203,54203,53074,53074,55880,55880,55146,55146,51581,51581,51489,51489,49417,49417,55257,55257,49715,49715,53613,53613,63613,63613,58223,58223,57538,57538,57741,57741,57556,57556,59357,59357,56243,56243,55583,55583,54192,54192,61131,61131,52985,52985,60339,60339,68793,68793,61753,61753,67056,67056,63327,63327,63359,63359,68421,68421,60834,60834,61304,61304,59785,59785,64822,64822,59941,59941,63113,63113,71579,71579,68859,68859,72999,72999,69543,69543,73089,73089,75585,75585,64318,64318,67065,67065,64883,64883,68316,68316,60619,60619,64321,64321,77611,77611,74532,74532,79046,79046,73171,73171,77651,77651,79978,79978,71340,71340,72434,72434,68604,68604,76259,76259,68415,68415,68917,68917,82636,82636,79486,79486,82885,82885,79754,79754,83376,83376,84447,84447,78083,78083,77759,77759,73135,73135,81557,81557,69691,69691,77505,77505,85501,85501,82261,82261,83174,83174,82217,82217,84725,84725,88968,88968,81681,81681,79620,79620,77891,77891,88267,88267,73743,73743,76778,76778,90030,90030,81286,81286,88544,88544,85345,85345,86294,86294,88857,88857,85364,85364,83311,83311,81569,81569,87067,87067,75875,75875,76724,76724,93316,93316,83245,83245,91475,91475,87380,87380,87371,87371,91578,91578,81457,81457,84237,84237,81684,81684,88553,88553,75271,75271,76634,76634,93879,93879,86774,86774,94030,94030,87931,87931,92447,92447,98149,98149,85390,85390,89148,89148,87851,87851,91114,91114,80728,80728,84600,84600,68585,68585,56406,56406,88480,88480,93559,93559,97104,97104,98206,98206,96980,96980,98478,98478,89223,89223,101956,101956],[93.23999999999999,6.76,92.64,7.36,92.79000000000001,7.21,91.5,8.5,93.02,6.98,93.27,6.73,93.01000000000001,6.99,93.08,6.92,93.48999999999999,6.51,93.19,6.81,94.01000000000001,5.99,94.39,5.61,92.73,7.27,92.25,7.75,92.53,7.47,92.70999999999999,7.29,93.42,6.58,93.51000000000001,6.49,93.22,6.78,93.61,6.39,93.75,6.25,93.29000000000001,6.71,93.36,6.64,93.95,6.05,93.14,6.86,92.93000000000001,7.07,93.70999999999999,6.29,93.20999999999999,6.79,93.48999999999999,6.51,93.45,6.55,92.92,7.08,92.51000000000001,7.49,92.83,7.17,92.12,7.88,93.20999999999999,6.79,93.3,6.7,92.37,7.63,92.18000000000001,7.82,92.62,7.38,92.70999999999999,7.29,93.01000000000001,6.99,93.01000000000001,6.99,91.89,8.109999999999999,92.52,7.48,92.36,7.64,92.66,7.34,92.7,7.3,93.28,6.72,92.69,7.31,92.06999999999999,7.93,91.72,8.279999999999999,91.68000000000001,8.32,92.58,7.42,92.5,7.5,92.47,7.53,92.61,7.39,92.76000000000001,7.24,92.48999999999999,7.51,92.19,7.81,92.51000000000001,7.49,92.02,7.98,91.26000000000001,8.74,91.83,8.17,91.47,8.529999999999999,91.91,8.09,91.70999999999999,8.289999999999999,91.89,8.109999999999999,92.26000000000001,7.74,92.09999999999999,7.9,92.03,7.97,92.15000000000001,7.85,92.3,7.7,91.51000000000001,8.49,90.58,9.42,91.26000000000001,8.74,91.45,8.550000000000001,91.83,8.17,91.56,8.44,91.06,8.94,90.95,9.050000000000001,91.5,8.5,91.16,8.84,91.83,8.17,92.26000000000001,7.74,91.08,8.92,90.77,9.23,91.63,8.369999999999999,91.31,8.69,91.5,8.5,91.53,8.470000000000001,91.69,8.31,91.91,8.09,91.95999999999999,8.039999999999999,91.62,8.380000000000001,91.73999999999999,8.26,92.19,7.81,91.48,8.52,90.94,9.06,91.62,8.380000000000001,91.44,8.56,92.02,7.98,91.73,8.27,91.39,8.609999999999999,91.79000000000001,8.210000000000001,91.47,8.529999999999999,91.73,8.27,91.91,8.09,91.91,8.09,91.05,8.949999999999999,90.92,9.08,91.36,8.640000000000001,91.29000000000001,8.710000000000001,91.52,8.48,91.69,8.31,91.68000000000001,8.32,91.87,8.130000000000001,91.90000000000001,8.1,93.08,6.92,92.22,7.78,92.3,7.7,90.93000000000001,9.07,90.47,9.529999999999999,91.33,8.67,91.27,8.73,91.25,8.75,91.42,8.58,92.06,7.94,91.98999999999999,8.01,91.40000000000001,8.6,91.04000000000001,8.960000000000001,90.98,9.02,92.12,7.88,90.42,9.58,89.7,10.3,90.5,9.5,90.92,9.08,91.42,8.58,91.59999999999999,8.4,91.83,8.17,91.78,8.220000000000001,91.59999999999999,8.4,91.37,8.630000000000001,91.47,8.529999999999999,92.31999999999999,7.68,90.45,9.550000000000001,90.13,9.869999999999999,90.92,9.08,90.90000000000001,9.1,90.98,9.02,91.17,8.83,91.34,8.66,90.88,9.119999999999999,91.27,8.73,90.18000000000001,9.82,90.25,9.75,91.47,8.529999999999999,89.16,10.84,88.70999999999999,11.29,90.3,9.699999999999999,90.65000000000001,9.35,90.90000000000001,9.1,91.59999999999999,8.4,91.93000000000001,8.07,90.69,9.31,90.34,9.66,89.55,10.45,90.33,9.67,91.58,8.42,89.7,10.3,89.15000000000001,10.85,89.98,10.02,89.78,10.22,90.19,9.81,90.27,9.73,90.68000000000001,9.32,90.56999999999999,9.43,89.98999999999999,10.01,89.69,10.31,90.18000000000001,9.82,91.04000000000001,8.960000000000001,89.31999999999999,10.68,88.92,11.08,89.70999999999999,10.29,89.54000000000001,10.46,89.8,10.2,89.61,10.39,89.75,10.25,89.75,10.25,89.44,10.56,89.53,10.47,89.59,10.41,90.34,9.66,88.38,11.62,87.76000000000001,12.24,88.68000000000001,11.32,88.59,11.41,89.23,10.77,88.15000000000001,11.85,88.88,11.12,89.2,10.8,88.67,11.33,87.84999999999999,12.15,88.58,11.42,89.45,10.55,86.66,13.34,85.27,14.73,87.08,12.92,87.47,12.53,88.3,11.7,88.23999999999999,11.76,89.28,10.72,89.68000000000001,10.32,87.72,12.28,88.52,11.48,88.78,11.22,89.86,10.14,87.84,12.16,85.5,14.5,88.36,11.64,88.76000000000001,11.24,89.19,10.81,88.33,11.67,88.94,11.06,88.59999999999999,11.4,88.42,11.58,88.11,11.89,88.66,11.34,90.01000000000001,9.99,87.98,12.02,86.39,13.61,87.95999999999999,12.04,88.93000000000001,11.07,89.12,10.88,88.81,11.19,88.97,11.03,89.15000000000001,10.85,89.42,10.58,89.73,10.27,89.8,10.2,90.77,9.23,88.89,11.11,87.19,12.81,88.72,11.28,88.97,11.03,90.06,9.94,89.48999999999999,10.51,89.88,10.12,89.42,10.58,89.51000000000001,10.49,89.48,10.52,89.68000000000001,10.32,90.64,9.359999999999999,88.70999999999999,11.29,86.7,13.3,88.47,11.53,89.23999999999999,10.76,90.15000000000001,9.85,89.98,10.02,90.47,9.529999999999999,90.38,9.619999999999999,90.29000000000001,9.710000000000001,90.04000000000001,9.960000000000001,90.47,9.529999999999999,91.81,8.19,89.98999999999999,10.01,87.53,12.47,88.97,11.03,89.8,10.2,90.27,9.73,89.69,10.31,90.14,9.859999999999999,90.08,9.92,89.37,10.63,89.05,10.95,90.06,9.94,90.81999999999999,9.18,89.13,10.87,86.81,13.19,88.70999999999999,11.29,88.72,11.28,89.69,10.31,89.55,10.45,89.95,10.05,90.11,9.890000000000001,90.15000000000001,9.85,89.83,10.17,90.16,9.84,91.3,8.699999999999999,89.04000000000001,10.96,86.75,13.25,88.37,11.63,88.95,11.05,89.79000000000001,10.21,89.18000000000001,10.82,89.68000000000001,10.32,89.56,10.44,89.69,10.31,88.95999999999999,11.04,89.90000000000001,10.1,90.41,9.59,88.48,11.52,87.5,12.5,87.83,12.17,88.64,11.36,89.02,10.98,88.54000000000001,11.46,88.95999999999999,11.04,89.16,10.84,89.15000000000001,10.85,89.03,10.97,89.45999999999999,10.54,90.55,9.449999999999999,88.34999999999999,11.65,87.06999999999999,12.93,87.93000000000001,12.07,88.54000000000001,11.46,88.95999999999999,11.04,88.81,11.19,88.8,11.2,88.98999999999999,11.01,89.01000000000001,10.99,89.19,10.81,89.40000000000001,10.6,90.54000000000001,9.460000000000001,88.27,11.73,87.38,12.62,87.37,12.63,88.08,11.92,88.78,11.22,88.54000000000001,11.46,88.91,11.09,89.45,10.55,88.98999999999999,11.01,89.12,10.88,89.34999999999999,10.65,90.48999999999999,9.51,88.89,11.11,87.51000000000001,12.49,86.48,13.52,88.65000000000001,11.35,87.90000000000001,12.1,87.20999999999999,12.79,87.22,12.78,87.59,12.41,88.58,11.42,88.87,11.13,88.84,11.16,90.62,9.380000000000001]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sales_month<\/th>\n      <th>kind_of_business<\/th>\n      <th>category_sales<\/th>\n      <th>total_sales<\/th>\n      <th>category_percent<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollY":true,"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>new_and_used_car_sales_percent_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(new_and_used_car_sales_percent_tbl, <span class="fu">aes</span>(<span class="at">x =</span> sales_month, <span class="at">y =</span> category_percent, <span class="at">color =</span> kind_of_business ))<span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">colour=</span><span class="st">"#333333"</span>)<span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">"3 years"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">date_format</span>(<span class="st">"%Y"</span>))<span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">1</span>),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'New car dealers'</span> <span class="ot">=</span> <span class="st">"#222222"</span>, <span class="st">'Used car dealers'</span> <span class="ot">=</span> <span class="st">"#1380A1"</span>))<span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'New and used car dealers sales as percent of monthly total </span><span class="sc">\n</span><span class="st">in the US 1992-2020'</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Car dealers' sales of new and used cars over the last few decades </span><span class="sc">\n</span><span class="st">have not changed significantly as a percentage of the monthly total."</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Sales Month'</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Percent'</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ts</span>()<span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(),</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">18</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">15</span>, <span class="st">"pt"</span>)),</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>,  <span class="at">size =</span> <span class="dv">18</span>, </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">0</span>, <span class="st">"pt"</span>)),</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a> (new_and_used_car_sales_percent_plot <span class="ot">&lt;-</span> new_and_used_car_sales_percent_plot <span class="sc">+</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2020-01-01"</span>), <span class="at">y =</span> <span class="dv">80</span>, <span class="at">label =</span> <span class="st">"New </span><span class="sc">\n</span><span class="st">car"</span>), </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">vjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">"#222222"</span>, </span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.size =</span> <span class="cn">NA</span>, </span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">family=</span><span class="st">"Microsoft Sans Serif"</span>, </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2020-01-01"</span>), <span class="at">y =</span> <span class="dv">7</span>, <span class="at">label =</span> <span class="st">"Used </span><span class="sc">\n</span><span class="st">car"</span>), </span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">vjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">"#1380A1"</span>, </span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">label.size =</span> <span class="cn">NA</span>, </span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">family=</span><span class="st">"Microsoft Sans Serif"</span>, </span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1_time_series_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="3600"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="during-the-past-few-decades-how-have-sales-of-new-and-used-cars-dealers-varied-in-dollars-and-percent" class="level2">
<h2 class="anchored" data-anchor-id="during-the-past-few-decades-how-have-sales-of-new-and-used-cars-dealers-varied-in-dollars-and-percent">During the past few decades, how have sales of <code>new and used cars dealers</code> varied in dollars and percent?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>gap_percent_sales_cars <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="st">WITH car_sales AS </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="st">    (SELECT </span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="st">        EXTRACT (YEAR FROM rs.sales_month) AS year,</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="st">        sum(CASE WHEN upper(rs.kind_of_business) = upper('New car dealers') THEN rs.sales END) AS new_car_sales,</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="st">        sum(CASE WHEN upper(rs.kind_of_business) = upper('Used car dealers') THEN rs.sales END) AS used_car_sales</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM training_data.retail_sales rs</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="st">    GROUP BY EXTRACT (YEAR FROM rs.sales_month)</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="st">    ORDER BY year)</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="st">    cs.year,</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="st">    cs.new_car_sales,</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="st">    cs.used_car_sales,</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="st">    (cs.new_car_sales - cs.used_car_sales) AS delta,</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="st">    round((cs.new_car_sales / cs.used_car_sales), 2) AS ratio,</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="st">    round(((cs.new_car_sales / cs.used_car_sales) -1)*100, 2) AS percent</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="st">FROM car_sales cs;</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>gap_percent_sales_cars_tbl <span class="ot">&lt;-</span> (<span class="fu">dbGetQuery</span>(con, gap_percent_sales_cars))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-626c86a01213db878c49" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-626c86a01213db878c49">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29"],[1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020],[333801,379522,435661,464642,502340,518972,542559,606167,630123,649413,645759,659205,670553,681947,685622,687707,575593,486565,549473,608788,672550,735374,785142,842120,875596,896014,908505,939551,930265],[24643,27604,32439,37042,41609,45686,50942,55653,57659,58263,60923,63055,67521,71124,75176,79696,73912,65431,71707,75717,80228,83916,90424,98330,105905,112174,114390,119067,124040],[309158,351918,403222,427600,460731,473286,491617,550514,572464,591150,584836,596150,603032,610823,610446,608011,501681,421134,477766,533071,592322,651458,694718,743790,769691,783840,794115,820484,806225],[13.55,13.75,13.43,12.54,12.07,11.36,10.65,10.89,10.93,11.15,10.6,10.45,9.93,9.59,9.119999999999999,8.630000000000001,7.79,7.44,7.66,8.039999999999999,8.380000000000001,8.76,8.68,8.56,8.27,7.99,7.94,7.89,7.5],[1254.55,1274.88,1243.02,1154.37,1107.29,1035.95,965.05,989.1900000000001,992.84,1014.62,959.96,945.4400000000001,893.1,858.8099999999999,812.02,762.91,678.75,643.63,666.28,704.03,738.3,776.3200000000001,768.29,756.42,726.77,698.77,694.22,689.09,649.97]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>year<\/th>\n      <th>new_car_sales<\/th>\n      <th>used_car_sales<\/th>\n      <th>delta<\/th>\n      <th>ratio<\/th>\n      <th>percent<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollY":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>gap_percent_sales_cars_tbl <span class="ot">&lt;-</span> gap_percent_sales_cars_tbl<span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(year, <span class="st">"-01-01"</span>)))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>gap_sales_cars_tbl_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gap_percent_sales_cars_tbl, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> delta))<span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"#222222"</span>)<span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">colour=</span><span class="st">"#333333"</span>)<span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">'5 years'</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">date_format</span>(<span class="st">'%Y'</span>))<span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>())<span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'The yearly difference in dollars between sales </span><span class="sc">\n</span><span class="st">of new and used cars increased from 1992 to 2006, </span><span class="sc">\n</span><span class="st">followed by a decrease until 2009 when </span><span class="sc">\n</span><span class="st">it returned to 1995 levels.Then it increased again until </span><span class="sc">\n</span><span class="st">2019 when it started to decrease.'</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Year'</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'$MM'</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ts</span>()<span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(),</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">18</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">15</span>, <span class="st">"pt"</span>)),</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>,  <span class="at">size =</span> <span class="dv">18</span>, </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">0</span>, <span class="st">"pt"</span>)),</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>percent_sales_cars_tbl_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gap_percent_sales_cars_tbl, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> percent))<span class="sc">+</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"#222222"</span>)<span class="sc">+</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">colour=</span><span class="st">"#333333"</span>)<span class="sc">+</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">'5 years'</span>,</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">date_format</span>(<span class="st">'%Y'</span>))<span class="sc">+</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">1</span>),</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1300</span>, <span class="dv">250</span>))<span class="sc">+</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'From 1993 to 2009, the percent difference between </span><span class="sc">\n</span><span class="st">sales at new car dealers and used car </span><span class="sc">\n</span><span class="st">dealers declined (it slightly increased in 2001). </span><span class="sc">\n</span><span class="st">Then, the percent diffrenece increased until 2014, </span><span class="sc">\n</span><span class="st">and again decreased until 2020, returning </span><span class="sc">\n</span><span class="st">to 2009 values.'</span>,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Year'</span>,</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Percent'</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ts</span>()<span class="sc">+</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(),</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">18</span>,</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">15</span>, <span class="st">"pt"</span>)),</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>,  <span class="at">size =</span> <span class="dv">18</span>, </span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">0</span>, <span class="st">"pt"</span>)),</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>(combine_plot <span class="ot">&lt;-</span> gap_sales_cars_tbl_plot <span class="sc">+</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_spacer</span>() <span class="sc">+</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>  percent_sales_cars_tbl_plot <span class="sc">+</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="sc">-</span><span class="fl">0.0005</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Yearly sales and percent difference between sales at new </span><span class="sc">\n</span><span class="st">and used car dealers in the US 1992-2020'</span>) <span class="sc">&amp;</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">28</span>))</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1_time_series_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="3600"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In the above examples, I practiced simple techniques to trend time series data, including aggregating data from monthly to yearly to make the results easier to understand, comparing components, and using percent of the total to compare parts to the whole. Time series analysis is a powerful way to analyze data. In the next post, I will practice and share more methods for smoothing time series data.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="CozminaSecula/blogComments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Â© 2024 Cozmina Secula âˆ™ Made with <a href="https://quarto.org">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>